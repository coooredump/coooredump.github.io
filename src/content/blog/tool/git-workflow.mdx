---
title: Git ä¸ªäººå·¥ä½œæµåˆ†äº«
description: æœ‰å…³ git çš„å¸¸ç”¨æŒ‡ä»¤
publishDate: 2025-04-12
tags: [tool]
heroImage: { src: ../_img/202311150150548.jpg }
language: Chinese
comment: true
draft: false
---

## æŸ¥çœ‹æœ¬åœ°åˆ†æ”¯ä¸è¿œç¨‹åˆ†æ”¯çš„å¯¹åº”å…³ç³»

```shell
# æŸ¥çœ‹è¿œç¨‹åˆ†æ”¯ä¸æœ¬åœ°åˆ†æ”¯çš„å¯¹åº”å…³ç³»
$ git branch -vv
# æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯ï¼ˆè¿œç¨‹ + æœ¬åœ°ï¼‰
$ git branch -a
```

## æ–°å»ºè¿œç¨‹åˆ†æ”¯ | `push`

```shell
$ git checkout <local-branch>
# æœ¬åœ°åˆ†æ”¯å’Œè¿œç¨‹åˆ†æ”¯çš„åå­—å¯ä¸ä¸€æ ·ï¼Œä½†ä¸€èˆ¬æ˜¯åŒååˆ†æ”¯ | å…³è”å (--set-upstream) å¯ç›´æ¥ push
# git push origin master è¿™ä¸ªmasteræŒ‡çš„æ˜¯è¿œç¨‹åˆ†æ”¯ï¼Œå› ä¸ºæœ¬åœ°åˆ†æ”¯é»˜è®¤ä¸ºå½“å‰åˆ†æ”¯
$ git push origin <local-branch>:<remote-branch>
```

Tip: `push` çš„æ—¶å€™åªä¼šä¸Šä¼ å½“å‰çš„ `branch` çš„æŒ‡å‘ï¼Œå¹¶ä¸ä¼šæŠŠæœ¬åœ°çš„ `HEAD` çš„æŒ‡å‘ä¹Ÿä¸€èµ·ä¸Šä¼ åˆ°è¿œç¨‹ä»“åº“ã€‚äº‹å®ä¸Šï¼Œè¿œç¨‹ä»“åº“çš„ `HEAD` æ˜¯æ°¸è¿œæŒ‡å‘å®ƒçš„é»˜è®¤åˆ†æ”¯ï¼ˆå³ masterï¼Œå¦‚æœä¸ä¿®æ”¹å®ƒçš„åç§°çš„è¯ï¼‰ï¼Œå¹¶ä¼šéšç€é»˜è®¤åˆ†æ”¯çš„ç§»åŠ¨è€Œç§»åŠ¨çš„ã€‚

## `--set-upstream` è®¾ç½®è¿œç¨‹åˆ†æ”¯ä¸æœ¬åœ°åˆ†æ”¯å…³è”

```shell
# å…³è”è¿œç¨‹ä»“åº“çš„ master åˆ†æ”¯ä¸æœ¬åœ°çš„ master åˆ†æ”¯ï¼Œè¯¥æ–¹æ³•åœ¨ push ä¸­å¯è®¾ç½®ï¼Œå¦‚æœè¦ç›´æ¥ç»‘å®šåˆ†æ”¯ä½†ä¸ push å‘¢ï¼Œè§ä¸‹é¢å‘½ä»¤è¡Œ
$ git push --set-upstream origin master:master
# é€šè¿‡ branch å‘½ä»¤ç›´æ¥è®¾ç½®
$ git branch --set-upstream-to=origin/feature2 feature2
```

![](https://cdn.jsdelivr.net/gh/Wu-yikun/OSS/PicGo/202305221418898.png)

## æ‹‰å–è¿œç¨‹åˆ†æ”¯ | `pull`

```shell
# è¯´æ˜ï¼šå…³è”å (--set-upstream) å¯ç›´æ¥ push
# git pull origin master è¿™ä¸ª master æŒ‡çš„æ˜¯è¿œç¨‹åˆ†æ”¯ï¼Œå› ä¸ºæœ¬åœ°åˆ†æ”¯é»˜è®¤ä¸ºå½“å‰åˆ†æ”¯
$ git pull origin <remote-branch>:<local-branch>
```

## æ ¹æ®è¿œç¨‹åˆ†æ”¯ä¸Šåˆ›å»ºæœ¬åœ°åˆ†æ”¯

```shell
# åªæœ‰è¿œç¨‹åˆ†æ”¯çš„æ—¶å€™ï¼Œæ ¹æ®è¿œç¨‹åˆ†æ”¯åˆ›å»ºæœ¬åœ°åˆ†æ”¯å³å¯
$ git checkout -b <local-branch> origin/<remote-branch>
```

## åˆ é™¤è¿œç¨‹åˆ†æ”¯

```shell
# è¯´æ˜ï¼šgit push origin <local-branch>/<remote-branch>
# Method1: æ¨é€ç©ºåˆ†æ”¯åˆ°è¿œç¨‹åˆ†æ”¯ remote-branchï¼Œç›¸å½“äºåˆ é™¤è¿œç¨‹åˆ†æ”¯
$ git push origin :<remote-branch>
# Method2: ç›´æ¥åˆ é™¤è¿œç¨‹åˆ†æ”¯
$ git push origin --delete <remote-branch>
# Tip: åˆ é™¤æœ¬åœ°åˆ†æ”¯
$ git branch -d <local-branch>
```

## åŒºåˆ† `git reset` & `git checkout`

â­Reference: https://blog.csdn.net/longintchar/article/details/82314102

![](https://cdn.jsdelivr.net/gh/Wu-yikun/OSS/PicGo/202305290945794.png)

- `git reset` ä¼šå¸¦ç€å½“å‰æŒ‡å‘çš„ branch ä¸€èµ·å‘å‰æ¨è¿›
- `git checkout` åªä¼šä¿®æ”¹å½“å‰ HEAD çš„æŒ‡å‘ï¼Œå¯å…ˆç”¨ checkout è·³è½¬åˆ°æŸæ¬¡æäº¤å¤„ï¼Œç„¶ååˆ›å»ºæŸä¸ªåˆ†æ”¯ featureï¼ˆæ­¤æ—¶çš„ HEAD å¹¶æœªæŒ‡å‘ feature1ï¼Œè€Œæ˜¯ä»…ä»…å¤„äºåŒä¸€å¤„ commitï¼‰ï¼Œæœ€åå†ä½¿ç”¨ checkout åˆ‡æ¢åˆ°è¯¥ feature åˆ†æ”¯ä¸Šï¼ˆå³ HEAD æŒ‡å‘ feature åˆ†æ”¯ï¼‰

---

`checkout` ç­¾å‡ºåŠ¨ä½œä¼šå°† HEAD ä¸ branch åˆ†ç¦»å¼€æ¥ï¼Œå®ƒæœ‰ä¸€ä¸ªä¸“é—¨çš„å‚æ•°ç”¨äºè®© HEAD ä¸ branch è„±ç¦»ä¸”ä¸ç§»åŠ¨ HEAD çš„ç”¨æ³•ï¼š

```shell
$ git checkout --detach
```

![git checkout --detach](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2017/11/30/1600acce7b90b009~tplv-t2oaga2asx-zoom-in-crop-mark:3024:0:0:0.awebp)


## git å„å¼åæ‚”è¯

git ç®¡ç†ä»“åº“æ—¶ï¼Œå¾€å¾€éœ€è¦æ’¤é”€æŸäº›æ“ä½œ/æäº¤/æš‚å­˜å†…å®¹ã€‚

### 1. æ’¤é”€å·¥ä½œåŒºçš„æ–‡ä»¶ä¿®æ”¹

å¦‚æœå·¥ä½œåŒºçš„æŸä¸ªæ–‡ä»¶è¢«æ”¹ä¹±äº†ï¼Œä½†è¿˜æ²¡æœ‰æ‰§è¡Œ `git add`ï¼Œå¯ä»¥ç”¨ `git checkout` å‘½ä»¤**æ‰¾å›æœ¬æ¬¡ä¿®æ”¹ä¹‹å‰çš„æ–‡ä»¶**ã€‚

```bash
$ git checkout -- [filename]
```

â­å®ƒçš„åŸç†æ˜¯å…ˆæ‰¾æš‚å­˜åŒºï¼Œå¦‚æœè¯¥æ–‡ä»¶æœ‰æš‚å­˜çš„ç‰ˆæœ¬ï¼Œåˆ™æ¢å¤è¯¥ç‰ˆæœ¬ï¼Œå¦åˆ™æ¢å¤ä¸Šä¸€æ¬¡æäº¤çš„ç‰ˆæœ¬ã€‚

**æ³¨æ„**ï¼šå·¥ä½œåŒºçš„æ–‡ä»¶å˜åŒ–ä¸€æ—¦è¢«æ’¤é”€ï¼Œå°±æ— æ³•æ‰¾å›äº†ã€‚

### 2. ä»æš‚å­˜åŒºæ’¤é”€æ–‡ä»¶

å¦‚æœä¸å°å¿ƒæŠŠä¸€ä¸ªæ–‡ä»¶æ·»åŠ åˆ°æš‚å­˜åŒºï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„å‘½ä»¤æ’¤é”€ã€‚

```bash
$ git rm --cached [filename]
```

ä¸Šé¢çš„å‘½ä»¤ä¸å½±å“å·²ç»æäº¤çš„å†…å®¹ã€‚

### 3. æ›¿æ¢ä¸Šä¸€æ¬¡æäº¤ä¿¡æ¯

ğŸ’”æƒ…å†µä¸€ï¼š**æäº¤ä»¥åï¼Œå‘ç°æäº¤ä¿¡æ¯å†™é”™äº†**ï¼Œè¿™æ—¶å¯ä»¥ä½¿ç”¨ `git commit` å‘½ä»¤çš„ `--amend` å‚æ•°ï¼Œå¯ä»¥ä¿®æ”¹ä¸Šä¸€æ¬¡çš„æäº¤ä¿¡æ¯ã€‚

```bash
$ git commit --amend -m "Fixes bug #42"
# git commit --amend ä¹Ÿå¯
```

å®ƒçš„åŸç†æ˜¯äº§ç”Ÿä¸€ä¸ªæ–°çš„æäº¤å¯¹è±¡ï¼Œæ›¿æ¢æ‰ä¸Šä¸€æ¬¡æäº¤äº§ç”Ÿçš„æäº¤å¯¹è±¡ã€‚

ğŸ’”æƒ…å†µäºŒï¼š**æäº¤ä¹‹åï¼Œå‘ç°æäº¤çš„æ–‡ä»¶éœ€è¦ä¿®æ”¹**ï¼è¿™æ—¶å…ˆä¿®æ”¹å¥½å·¥ä½œåŒºï¼Œç„¶åå†æ‰§è¡Œ `add` åæ‰§è¡Œ `git commit --amend`ï¼Œå› ä¸º**è¿™æ—¶æš‚å­˜åŒºæœ‰å‘ç”Ÿå˜åŒ–çš„æ–‡ä»¶ï¼Œä¼šä¸€èµ·æäº¤åˆ°ä»“åº“ã€‚**

```shell
$ git commit --amend -m "append info"
# git commit --amend ä¹Ÿå¯
```

æ‰€ä»¥ï¼Œ`--amend` ä¸ä»…å¯ä»¥ä¿®æ”¹æäº¤ä¿¡æ¯ï¼Œè¿˜å¯ä»¥æ•´ä¸ªæŠŠä¸Šä¸€æ¬¡æäº¤æ›¿æ¢æ‰ã€‚

### 4. æ’¤é”€æŸæ¬¡æäº¤ | ä½†éœ€æ–°å¢æ¥è¦†ç›–æäº¤

ä¸€ç§å¸¸è§çš„åœºæ™¯æ˜¯ï¼Œæäº¤ä»£ç ä»¥åï¼Œä½ çªç„¶æ„è¯†åˆ°è¿™ä¸ªæäº¤æœ‰é—®é¢˜ï¼Œåº”è¯¥æ’¤é”€æ‰ï¼Œè¿™æ—¶æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤å°±å¯ä»¥äº†ã€‚

```bash
$ git revert HEAD
```

![](https://cdn.jsdelivr.net/gh/Wu-yikun/OSS/PicGo/202305251012520.png)

ä¸Šé¢å‘½ä»¤çš„åŸç†æ˜¯ï¼Œåœ¨å½“å‰æäº¤åé¢ï¼Œâ­**æ–°å¢ä¸€æ¬¡æäº¤(commit+1)ï¼ŒæŠµæ¶ˆæ‰ä¸Šä¸€æ¬¡æäº¤å¯¼è‡´çš„æ‰€æœ‰å˜åŒ–(workspace&stage change)**ã€‚å®ƒ**ä¸ä¼šæ”¹å˜è¿‡å»çš„å†å²**ï¼Œæ‰€ä»¥æ˜¯é¦–é€‰æ–¹å¼ï¼Œ**æ²¡æœ‰ä»»ä½•ä¸¢å¤±ä»£ç çš„é£é™©**ã€‚

`git revert` å‘½ä»¤åªèƒ½æŠµæ¶ˆä¸Šä¸€ä¸ªæäº¤ï¼Œå¦‚æœæƒ³æŠµæ¶ˆå¤šä¸ªæäº¤ï¼Œå¿…é¡»åœ¨å‘½ä»¤è¡Œä¾æ¬¡æŒ‡å®šè¿™äº›æäº¤ã€‚æ¯”å¦‚ï¼ŒæŠµæ¶ˆå‰ä¸¤ä¸ªæäº¤ï¼Œè¦åƒä¸‹é¢è¿™æ ·å†™ã€‚

```bash
$ git revert [å€’æ•°ç¬¬ä¸€ä¸ªæäº¤] [å€’æ•°ç¬¬äºŒä¸ªæäº¤]
```

`git revert` å‘½ä»¤è¿˜æœ‰ä¸¤ä¸ªå‚æ•°ã€‚

- `--no-edit`ï¼šæ‰§è¡Œæ—¶ä¸æ‰“å¼€é»˜è®¤ç¼–è¾‘å™¨ï¼Œç›´æ¥ä½¿ç”¨ Git è‡ªåŠ¨ç”Ÿæˆçš„æäº¤ä¿¡æ¯ã€‚
- `--no-commit`ï¼š**åªæŠµæ¶ˆæš‚å­˜åŒº(stage)å’Œå·¥ä½œåŒºçš„æ–‡ä»¶å˜åŒ–ï¼Œä¸äº§ç”Ÿæ–°çš„æäº¤**ã€‚

### 5. ä¸¢å¼ƒæäº¤ | å›æº¯

å¦‚æœå¸Œæœ›ä»¥å‰çš„æäº¤åœ¨å†å²ä¸­å½»åº•æ¶ˆå¤±ï¼Œè€Œä¸æ˜¯è¢«æŠµæ¶ˆæ‰ï¼Œå¯ä»¥ä½¿ç”¨`git reset`å‘½ä»¤ï¼Œä¸¢å¼ƒæ‰æŸä¸ªæäº¤ä¹‹åçš„æ‰€æœ‰æäº¤ã€‚

```bash
$ git reset [last good SHA]
```

`git reset`çš„åŸç†æ˜¯ï¼Œè®©æœ€æ–°æäº¤çš„æŒ‡é’ˆå›åˆ°ä»¥å‰æŸä¸ªæ—¶ç‚¹ï¼Œè¯¥æ—¶ç‚¹ä¹‹åçš„æäº¤éƒ½ä»å†å²ä¸­æ¶ˆå¤±ã€‚

é»˜è®¤æƒ…å†µä¸‹ï¼Œ`git reset`ä¸æ”¹å˜å·¥ä½œåŒºçš„æ–‡ä»¶ï¼ˆä½†ä¼šæ”¹å˜æš‚å­˜åŒºï¼‰ï¼Œ`--hard` å‚æ•°å¯ä»¥è®©å·¥ä½œåŒºé‡Œé¢çš„æ–‡ä»¶ä¹Ÿå›åˆ°ä»¥å‰çš„çŠ¶æ€ã€‚

```bash
$ git reset --hard [last good SHA]
# æˆ–è€…
$ git reset --hard HEAD^1
```

**æ‰§è¡Œ `git reset` å‘½ä»¤ä¹‹åï¼Œå¦‚æœæƒ³æ‰¾å›é‚£äº›ä¸¢å¼ƒæ‰çš„æäº¤ï¼Œå¯ä»¥ä½¿ç”¨ `git reflog` å‘½ä»¤**ï¼Œå…·ä½“åšæ³•å‚è€ƒ[è¿™é‡Œ](https://github.blog/2015-06-08-how-to-undo-almost-anything-with-git/#redo-after-undo-local)ã€‚ä¸è¿‡ï¼Œè¿™ç§åšæ³•æœ‰**æ—¶æ•ˆæ€§**ï¼Œæ—¶é—´é•¿äº†å¯èƒ½æ‰¾ä¸å›æ¥ã€‚

### 6. æ’¤é”€å½“å‰åˆ†æ”¯çš„å˜åŒ–

ä½ åœ¨å½“å‰ error åˆ†æ”¯ä¸Šåšäº†å‡ æ¬¡æäº¤ï¼Œçªç„¶å‘ç°**æ”¾é”™äº†åˆ†æ”¯**ï¼Œè¿™å‡ ä¸ªæäº¤æœ¬åº”è¯¥æ”¾åˆ° master åˆ†æ”¯ã€‚

```bash
# å°† error åˆ†æ”¯ä¸Šçš„<æœ€æ–°ä¸€æ¬¡>æäº¤è½¬ç§»åˆ° master åˆ†æ”¯
$ git checkout master
$ git cherry-pick error

# å°† error åˆ†æ”¯ä¸Šçš„å¤šæ¬¡æäº¤è½¬ç§»åˆ° master åˆ†æ”¯ï¼Œæ³¨æ„ï¼šSHA1 æ¯” SHA2 æ¥å¾—æ—©ï¼
$ git checkout master
$ git cherry-pick [SHA1] [SHA2]
```

> ç›®æ ‡ï¼šå°† error åˆ†æ”¯ä¸Šçš„æœ€æ–°ä¸¤æ¬¡ commit è½¬ç§»åˆ° master åˆ†æ”¯

![](https://cdn.jsdelivr.net/gh/Wu-yikun/OSS/PicGo/202305251129240.png)

> å…ˆæ‰§è¡Œ `git checkout master`
>
> å†æ‰§è¡Œ `git cherry-pick [SHA1] [SHA2]`
>
> æœ‰å†²çªè§£å†³å†²çªï¼Œæ²¡å†²çªå³å¯å®Œæˆ

![](https://cdn.jsdelivr.net/gh/Wu-yikun/OSS/PicGo/202305251130555.png)

> OKï¼error åˆ†æ”¯æƒ³è¦ reset å°± reset~

![](https://cdn.jsdelivr.net/gh/Wu-yikun/OSS/PicGo/202305251133726.png)

## åˆå¹¶åˆ†æ”¯ | `merge`

ç”±äºç°åœ¨ Git ä»“åº“å¤„äºå†²çªå¾…è§£å†³çš„ä¸­é—´çŠ¶æ€ï¼ˆå·²æ‰§è¡Œ `merge` æ“ä½œï¼‰ï¼Œæ‰€ä»¥å¦‚æœä½ æœ€ç»ˆå†³å®šæ”¾å¼ƒè¿™æ¬¡ `merge`ï¼Œä¹Ÿéœ€è¦æ‰§è¡Œä¸€æ¬¡ `merge --abort` æ¥æ‰‹åŠ¨å–æ¶ˆå®ƒã€‚

```shell
# å›åˆ° merge å‰çš„çŠ¶æ€
$ git merge --abort
# åœ¨ master åˆ†æ”¯ä¸Šåˆå¹¶ feature åˆ†æ”¯
$ git checkout master
$ git merge feature
```

## ä¸»æµå·¥ä½œæµ Feature Branching

è¿™ç§å·¥ä½œæµçš„æ ¸å¿ƒå†…å®¹å¯ä»¥æ€»ç»“ä¸ºä¸¤ç‚¹ï¼š

1. ä»»ä½•æ–°çš„åŠŸèƒ½ï¼ˆfeatureï¼‰æˆ– bug ä¿®å¤å…¨éƒ½æ–°å»ºä¸€ä¸ª `branch` æ¥å†™ï¼›
2. `branch` å†™å®Œåï¼Œåˆå¹¶åˆ° `master`ï¼Œç„¶ååˆ æ‰è¿™ä¸ª `branch`ã€‚

![Feature Branching](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2017/11/21/15fde6edbfe362c4~tplv-t2oaga2asx-zoom-in-crop-mark:3024:0:0:0.awebp)

è¿™å°±æ˜¯è¿™ç§å·¥ä½œæµæœ€åŸºæœ¬çš„æ¨¡å‹ã€‚

ä»ä¸Šé¢çš„åŠ¨å›¾æ¥çœ‹ï¼Œè¿™ç§å·¥ä½œæµä¼¼ä¹æ²¡ä»€ä¹ˆç‰¹åˆ«ä¹‹å¤„ã€‚ä½†å®è´¨ä¸Šï¼ŒFeature Branching è¿™ç§å·¥ä½œæµï¼Œä¸ºå›¢é˜Ÿå¼€å‘æ—¶ä¸¤ä¸ªå…³é”®çš„é—®é¢˜æä¾›äº†è§£å†³æ–¹æ¡ˆï¼š

- ä»£ç åˆ†äº«
- ä¸€äººå¤šä»»åŠ¡

### 1. ä»£ç åˆ†äº«

```shell
# æœ¬åœ°ç”µè„‘
$ git checkout -b books
$ git push origin books
# åŒäº‹ç”µè„‘
$ git pull
$ git checkout books
$ git checkout master
$ git pull	# merge ä¹‹å‰ pull ä¸€ä¸‹ï¼Œè®© master æ›´æ–°åˆ°å’Œè¿œç¨‹ä»“åº“åŒæ­¥
$ git merge books
$ git push
# åˆ é™¤æœ¬åœ° books åˆ†æ”¯ï¼Œåˆ é™¤è¿œç¨‹ books åˆ†æ”¯
$ git branch -d books
$ git push origin -d books
```

> å€ŸåŠ© GitHub çš„ Pull Request ç®€åŒ– Feature Branching å·¥ä½œæµ

äº‹å®ä¸Šï¼Œä¸Šé¢æ‰€è¯´çš„è¿™ä¸ªæµç¨‹ï¼Œè¿˜å¯ä»¥åˆ©ç”¨ **Pull Request** æ¥è¿›ä¸€æ­¥ç®€åŒ–ã€‚

Pull Request å¹¶ä¸æ˜¯ Git çš„å†…å®¹ï¼Œè€Œæ˜¯ä¸€äº› Git ä»“åº“æœåŠ¡æä¾›æ–¹ï¼ˆä¾‹å¦‚ GitHubï¼‰æ‰€æä¾›çš„ä¸€ç§ä¾¿æ·åŠŸèƒ½ï¼Œå®ƒå¯ä»¥è®©å›¢é˜Ÿçš„æˆå‘˜æ–¹ä¾¿åœ°è®¨è®ºä¸€ä¸ª `branch` ï¼Œå¹¶åœ¨è®¨è®ºç»“æŸåä¸€é”®åˆå¹¶è¿™ä¸ª `branch` åˆ° `master`ã€‚

åŒæ ·æ˜¯æŠŠå†™å¥½çš„ `branch` ç»™åŒäº‹çœ‹ï¼Œä½¿ç”¨ Pull Request çš„è¯ä½ å¯ä»¥è¿™æ ·åšï¼š

1. æŠŠ `branch` `push` åˆ°ä¸­å¤®ä»“åº“ï¼›
2. åœ¨ä¸­å¤®ä»“åº“å¤„åˆ›å»ºä¸€ä¸ª Pull Requestã€‚ä»¥ GitHub ä¸ºä¾‹ï¼š

![](https://cdn.jsdelivr.net/gh/Wu-yikun/OSS/PicGo/202305230950674.png)

ç„¶åä½ çš„åŒäº‹å°±å¯ä»¥åœ¨ GitHub ä¸Šçœ‹åˆ°ä½ åˆ›å»ºçš„ Pull Request äº†ã€‚ä»–ä»¬å¯ä»¥åœ¨ GitHub çš„è¿™ä¸ªé¡µé¢æŸ¥çœ‹ä½ çš„ `commit`sï¼Œä¹Ÿå¯ä»¥ç»™ä½ è¯„è®ºè¡¨ç¤ºèµåŒæˆ–ææ„è§ï¼Œä½ æ¥ä¸‹æ¥ä¹Ÿå¯ä»¥æ ¹æ®ä»–ä»¬çš„æ„è§æŠŠæ–°çš„ `commit`s `push` ä¸Šæ¥ï¼Œè¿™ä¹Ÿé¡µé¢ä¼šéšç€ä½ æ–°çš„ `push` è€Œå±•ç¤ºå‡ºæœ€æ–°çš„ `commits`ã€‚

åœ¨è®¨è®ºç»“æŸä»¥åï¼Œä½ ä»¬ä¸€è‡´è®¤ä¸ºè¿™ä¸ª `branch` å¯ä»¥åˆå¹¶äº†ï¼Œä½ åªéœ€è¦ç‚¹ä¸€ä¸‹é¡µé¢ä¸­é‚£ä¸ªç»¿è‰²çš„ "Merge pull request" æŒ‰é’®ï¼ŒGitHub å°±ä¼šè‡ªåŠ¨åœ°åœ¨ä¸­å¤®ä»“åº“å¸®ä½ æŠŠ `branch` åˆå¹¶åˆ° `master` äº†ï¼š

![](https://cdn.jsdelivr.net/gh/Wu-yikun/OSS/PicGo/202305230951662.png)

ç„¶åä½ åªè¦åœ¨æœ¬åœ° `pull` ä¸€ä¸‹ï¼ŒæŠŠæœ€æ–°çš„å†…å®¹æ‹‰åˆ°ä½ çš„ç”µè„‘ä¸Šï¼Œè¿™ä»¶äº‹æƒ…å°±ç®—å®Œæˆäº†ã€‚

å¦å¤–ï¼ŒGitHub è¿˜è®¾è®¡äº†ä¸€ä¸ªè´´å¿ƒçš„ "Delete branch" æŒ‰é’®ï¼Œæ–¹ä¾¿ä½ åœ¨åˆå¹¶ä¹‹åä¸€é”®åˆ é™¤ `branch`ã€‚

---

å®Œæ•´çš„ä¾‹å­ï¼š

![](https://cdn.jsdelivr.net/gh/Wu-yikun/OSS/PicGo/202305231003034.png)

![](https://cdn.jsdelivr.net/gh/Wu-yikun/OSS/PicGo/202305231004086.png)

![](https://cdn.jsdelivr.net/gh/Wu-yikun/OSS/PicGo/202305231004038.png)

![](https://cdn.jsdelivr.net/gh/Wu-yikun/OSS/PicGo/202305231005995.png)

```shell
# æ‹‰å– feature2 åˆ†æ”¯
$ git pull origin feature2:feature2
$ git branch --set-upstream-to=origin/feature2 feature2
$ git branch -vv
  feature1 c16362b [origin/feature1] Merge branch 'master' into feature1
* feature2 db3024c [origin/feature2] create branch feature2
  master   55c2952 [origin/master: behind 2] Merge pull request
$ git checkout master
# master åˆ†æ”¯ä¹Ÿè¦ pull
$ git pull origin master:master
```

![](https://cdn.jsdelivr.net/gh/Wu-yikun/OSS/PicGo/202305231015784.png)

### 2. ä¸€äººå¤šä»»åŠ¡

ä½ æ­£åœ¨è®¤çœŸå†™ç€ä»£ç ï¼Œå¿½ç„¶åŒäº‹è¿‡æ¥è·Ÿä½ è¯´ï¼šã€Œå†…ä¸ªâ€¦â€¦ä½ è¿™ä¸ªåŠŸèƒ½å…ˆæ”¾ä¸€æ”¾å§ï¼Œæˆ‘ä»¬æœ€æ–°è®¨è®ºå‡ºè¦åšå¦ä¸€ä¸ªæ›´é‡è¦çš„åŠŸèƒ½ï¼Œä½ æ¥åšä¸€ä¸‹å§ã€‚ã€

å¦‚æœä½ æ˜¯åœ¨ç‹¬ç«‹çš„ `branch` ä¸Šåšäº‹ï¼Œåˆ‡æ¢ä»»åŠ¡æ˜¯å¾ˆç®€å•çš„ã€‚ä½ åªè¦ç¨å¾®æŠŠç›®å‰æœªæäº¤çš„ä»£ç ç®€å•æ”¶å°¾ä¸€ä¸‹ï¼Œç„¶ååšä¸€ä¸ªå¸¦æœ‰ã€Œæœªå®Œæˆã€æ ‡è®°çš„æäº¤ï¼ˆä¾‹å¦‚ï¼Œåœ¨æäº¤ä¿¡æ¯é‡Œæ ‡ä¸Šã€ŒTODOã€ï¼‰ï¼Œç„¶åå›åˆ° `master` å»åˆ›å»ºä¸€ä¸ªæ–°çš„ `branch` å°±å¥½äº†ã€‚

```shell
# åˆ‡æ¢å› master ä¸»åˆ†æ”¯ï¼ï¼ï¼å› ä¸ºéœ€è¦ä»ä¸»åˆ†æ”¯ä¸Šåˆ›å»ºåˆ†æ”¯
$ git checkout master
$ git checkout -b new_feature
```

## æŸ¥æ”¹å†å²æ”¹åŠ¨è®°å½•

### git log

```shell
# åœ¨ .bashrc ä¸­è®¾ç½® git-log åˆ«åï¼Œå¯å›¾å½¢åŒ–è¾“å‡º git log çš„ä¿¡æ¯
$ alias git-log='git log --pretty=oneline --all --graph --abbrev-commit'
$ git-log
# æŸ¥çœ‹å†å²æ”¹åŠ¨ä¿¡æ¯
$ git log
# æŸ¥çœ‹è¯¦ç»†çš„å†å²è®°å½•ï¼Œå¯ä»¥çœ‹åˆ°æ¯ä¸ª commit çš„å…·ä½“æ”¹åŠ¨ç»†èŠ‚ï¼ˆ-p æ˜¯ --patch çš„ç¼©å†™ï¼‰
$ git log -p
# æŸ¥çœ‹ç®€è¦ç»Ÿè®¡ï¼Œåªæƒ³å¤§è‡´çœ‹ä¸€ä¸‹æ”¹åŠ¨å†…å®¹
$ git log --stat
```

### git show

```shell
# æŸ¥çœ‹æŸä¸ªå…·ä½“çš„ commit: $ git show æŸ¥çœ‹å½“å‰ commit
$ git show <SHA-1>
$ git show <SHA-1> <filename>	# å…·ä½“åˆ°æŸä¸ªæŒ‡å®šæ–‡ä»¶
```

### git diff

**æ¯”å¯¹æœ¬åœ°å·¥ä½œç›®å½•ä¸æš‚å­˜åŒºçš„å†…å®¹**ï¼ˆå³æ˜¾ç¤ºæœªä½¿ç”¨ `git add` åŠ å…¥æš‚å­˜åŒºçš„å†…å®¹ä¸æš‚å­˜åŒºçš„å†…å®¹çš„ä¸åŒä¹‹å¤„ï¼‰

```shell
$ git diff
diff --git a/README.md b/README.md
index 4b572c1..0f8ceb4 100644
--- a/README.md
+++ b/README.md
@@ -5,3 +5,4 @@
 4. `git branch feature1` && `git checkout feature1` && `git checkout master` && `git merge feature1` (feature1)
 5. master branch (feature branching, solve conflict by `pull request`)
 6. feature2
+7. å“ˆå“ˆå“ˆå“ˆ
```

**æ¯”å¯¹æš‚å­˜åŒºä¸ä¸Šä¸€æ¡æäº¤çš„å†…å®¹**ï¼ˆå³æ˜¾ç¤º `git add` åçš„å†…å®¹ä¸ä¸Šæ¬¡ `commit` ä¹‹é—´å†…å®¹çš„ä¸åŒä¹‹å¤„ï¼‰

```shell
# äºŒè€…å‘½ä»¤å®Œå…¨ç­‰ä»·
$ git diff --staged
$ git diff --cached
```

**æ¯”å¯¹å·¥ä½œç›®å½•å’Œä¸Šä¸€æ¡æäº¤çš„å†…å®¹**ï¼š

ä½¿ç”¨ `git diff HEAD` å¯ä»¥æ˜¾ç¤ºå·¥ä½œç›®å½•å’Œä¸Šä¸€æ¡æäº¤ä¹‹é—´çš„ä¸åŒï¼Œå®ƒæ˜¯ä¸Šé¢è¿™äºŒè€…çš„å†…å®¹ç›¸åŠ ã€‚æ¢å¥è¯è¯´ï¼Œè¿™æ¡æŒ‡ä»¤å¯ä»¥è®©ä½ çœ‹åˆ°ã€Œå¦‚æœä½ ç°åœ¨æŠŠæ‰€æœ‰æ–‡ä»¶éƒ½ `add` ç„¶å `git commit`ï¼Œä½ å°†ä¼šæäº¤ä»€ä¹ˆã€ï¼ˆä¸è¿‡éœ€è¦æ³¨æ„ï¼Œæ²¡æœ‰è¢« Git è®°å½•åœ¨æ¡ˆçš„æ–‡ä»¶ï¼ˆå³ä»æ¥æ²¡æœ‰è¢« add è¿‡ çš„æ–‡ä»¶ï¼Œuntracked files å¹¶ä¸ä¼šæ˜¾ç¤ºå‡ºæ¥ã€‚ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºå¯¹ Git æ¥è¯´å®ƒå¹¶ä¸å­˜åœ¨å•Šï¼‰ã€‚

![](https://cdn.jsdelivr.net/gh/Wu-yikun/OSS/PicGo/202305231055267.png)

```shell
$ git diff HEAD
# ä¹Ÿå¯ git diff <SHA-1>
```

å®è´¨ä¸Šï¼Œå¦‚æœä½ æŠŠ `HEAD` æ¢æˆåˆ«çš„ `commit`ï¼Œä¹Ÿå¯ä»¥æ˜¾ç¤ºå½“å‰å·¥ä½œç›®å½•å’Œè¿™æ¡ `commit` çš„åŒºåˆ«ã€‚

## ä¸å–œæ¬¢ merge çš„åˆ†å‰ï¼Œé‚£å°±ç”¨ rebase å§

rebase â€”â€” å˜åŸºï¼Ÿï¼

å…¶å®è¿™ä¸ªç¿»è¯‘è¿˜æ˜¯æ¯”è¾ƒå‡†ç¡®çš„ã€‚`rebase` çš„æ„æ€æ˜¯ï¼Œç»™ä½ çš„ `commit` åºåˆ—é‡æ–°è®¾ç½®åŸºç¡€ç‚¹ï¼ˆä¹Ÿå°±æ˜¯çˆ¶ `commit`ï¼‰ã€‚å±•å¼€æ¥è¯´å°±æ˜¯ï¼ŒæŠŠä½ æŒ‡å®šçš„ `commit` ä»¥åŠå®ƒæ‰€åœ¨çš„ `commit` ä¸²ï¼Œä»¥æŒ‡å®šçš„ç›®æ ‡ `commit` ä¸ºåŸºç¡€ï¼Œä¾æ¬¡é‡æ–°æäº¤ä¸€æ¬¡ã€‚ä¾‹å¦‚ä¸‹é¢è¿™ä¸ª `merge`ï¼š

```shell
# merge è¿‡æ¥ï¼›rebase è¿‡å»
$ git merge branch1
```

> master: 1-2-3-4-**7**
>
> branch1: 1-2-5-6-**7**

![img](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2017/11/21/15fdea7b6646a1f3~tplv-t2oaga2asx-zoom-in-crop-mark:3024:0:0:0.awebp)

å¦‚æœæŠŠ `merge` æ¢æˆ `rebase`ï¼Œå¯ä»¥è¿™æ ·æ“ä½œï¼š

```shell
$ git checkout branch1
# merge è¿‡æ¥ï¼›rebase è¿‡å»
$ git rebase master
```

> master: 1-2-3-4-**7-8**
>
> branch1: 1-2-**5-6**
>
> master ä¸Šçš„ 7ã€8 æ˜¯ branch1 ä¸Šçš„ 5ã€6 rebase è¿‡å»çš„~

![img](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2017/11/30/1600abd620a8e28c~tplv-t2oaga2asx-zoom-in-crop-mark:3024:0:0:0.awebp)

å¯ä»¥çœ‹å‡ºï¼Œé€šè¿‡ `rebase`ï¼Œ`5` å’Œ `6` ä¸¤æ¡ `commit`s æŠŠåŸºç¡€ç‚¹ä» `2` æ¢æˆäº† `4` ã€‚é€šè¿‡è¿™æ ·çš„æ–¹å¼ï¼Œå°±è®©æœ¬æ¥åˆ†å‰äº†çš„æäº¤å†å²é‡æ–°å›åˆ°äº†ä¸€æ¡çº¿ã€‚è¿™ç§ã€Œé‡æ–°è®¾ç½®åŸºç¡€ç‚¹ã€çš„æ“ä½œï¼Œå°±æ˜¯ `rebase` çš„å«ä¹‰ã€‚

å¦å¤–ï¼Œåœ¨ `rebase` ä¹‹åï¼Œè®°å¾—åˆ‡å› `master` å† `merge` ä¸€ä¸‹ï¼ŒæŠŠ `master` ç§»åˆ°æœ€æ–°çš„ `commit`ï¼š

```shell
$ git checkout master
$ git merge branch1
```

> master/branch1: 1-2-3-4-7-8

![img](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2017/12/2/160149e054fe485c~tplv-t2oaga2asx-zoom-in-crop-mark:3024:0:0:0.awebp)

> ä¸ºä»€ä¹ˆè¦ä» `branch1` æ¥ `rebase`ï¼Œç„¶åå†åˆ‡å› `master` å† `merge` ä¸€ä¸‹è¿™ä¹ˆéº»çƒ¦ï¼Œè€Œä¸æ˜¯ç›´æ¥åœ¨ `master` ä¸Šæ‰§è¡Œ `rebase`ï¼Ÿ
>
> ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œ`rebase` åçš„ `commit` è™½ç„¶å†…å®¹å’Œ `rebase` ä¹‹å‰ç›¸åŒï¼Œä½†å®ƒä»¬å·²ç»æ˜¯ä¸åŒçš„ `commits` äº†ã€‚å¦‚æœç›´æ¥ä» `master` æ‰§è¡Œ `rebase` çš„è¯ï¼Œå°±ä¼šæ˜¯ä¸‹é¢è¿™æ ·ï¼š
>
> ![img](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2017/12/2/16014b5a6919c0b7~tplv-t2oaga2asx-zoom-in-crop-mark:3024:0:0:0.awebp)
>
> è¿™å°±å¯¼è‡´ `master` ä¸Šä¹‹å‰çš„ä¸¤ä¸ªæœ€æ–° `commit` è¢«å‰”é™¤äº†ã€‚å¦‚æœè¿™ä¸¤ä¸ª `commit` ä¹‹å‰å·²ç»åœ¨ä¸­å¤®ä»“åº“å­˜åœ¨ï¼Œè¿™å°±ä¼šå¯¼è‡´æ²¡æ³• `push` äº†ï¼š
>
> ![img](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2017/12/2/16014bc64d4337f8~tplv-t2oaga2asx-zoom-in-crop-mark:3024:0:0:0.awebp)
>
> æ‰€ä»¥ï¼Œä¸ºäº†é¿å…å’Œè¿œç«¯ä»“åº“å‘ç”Ÿå†²çªï¼Œä¸€èˆ¬ä¸è¦ä» `master` å‘å…¶ä»– `branch` æ‰§è¡Œ `rebase` æ“ä½œã€‚è€Œå¦‚æœæ˜¯ `master` ä»¥å¤–çš„ `branch` ä¹‹é—´çš„ `rebase`ï¼ˆæ¯”å¦‚ `branch1` å’Œ `branch2` ä¹‹é—´)ï¼Œå°±ä¸å¿…è¿™ä¹ˆå¤šè´¹ä¸€æ­¥ï¼Œç›´æ¥ `rebase` å°±å¥½ã€‚

---

â­ä»¥ä¸Šæƒ…å†µæ˜¯ä¸å‘ç”Ÿå†²çªçš„ `rebase`ï¼Œå¦‚æœå‘ç”Ÿå†²çªäº†ï¼Œé‚£ä¹ˆå°±éœ€è¦å…ˆè§£å†³å†²çªå†æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š

> **ä»¥ä¸‹å±•ç¤ºå¦å¤–ä¸€ä¸ªä¾‹å­**ï¼

```shell
# 1.ä¿®æ”¹å†²çªæ–‡ä»¶
# 2.git add. & git commit -m "fix conflict"
# 3.rebase continue
$ git rebase --continue
```

> åˆå§‹çŠ¶æ€

![](https://cdn.jsdelivr.net/gh/Wu-yikun/OSS/PicGo/202305250955548.png)

> `git checkout rebase-branch`
>
> `git rebase master`ï¼šå‘ç”Ÿ conflict åœ¨ **"step 3"**ï¼

![](https://cdn.jsdelivr.net/gh/Wu-yikun/OSS/PicGo/202305250949354.png)

![](https://cdn.jsdelivr.net/gh/Wu-yikun/OSS/PicGo/202305250956107.png)

> è§£å†³å†²çªåï¼Œå†æ‰§è¡Œ `add` ä¸ `commit`ï¼ˆâ­ç”šè‡³è¿™ä¸€æ­¥éƒ½ä¸éœ€è¦ `commit`ï¼Œåœ¨ `add` ä¹‹åå³å¯ï¼‰

![](https://cdn.jsdelivr.net/gh/Wu-yikun/OSS/PicGo/202305251000282.png)

> `git rebase --continue`

![](https://cdn.jsdelivr.net/gh/Wu-yikun/OSS/PicGo/202305251001570.png)

> `git checkout master`
>
> `git merge rebase-branch`ï¼šç›¸å½“äº fast-forwardï¼

![](https://cdn.jsdelivr.net/gh/Wu-yikun/OSS/PicGo/202305251003603.png)

â­æ€»ç»“ï¼šéœ€è¦è¯´æ˜çš„æ˜¯ï¼Œ`rebase` æ˜¯ç«™åœ¨éœ€è¦è¢« `rebase` çš„ `commit` ä¸Šè¿›è¡Œæ“ä½œï¼Œè¿™ç‚¹å’Œ `merge` æ˜¯ä¸åŒçš„ï¼ˆç›¸åï¼‰ã€‚

## å¦‚ä½•ä¿®å¤å€’æ•°ç¬¬ 2 ä¸ª commit | äº¤äº’å¼ rebase

> `commit --amend` å¯ä»¥ä¿®å¤æœ€æ–° `commit` çš„é”™è¯¯ï¼Œä½†å¦‚æœæ˜¯å€’æ•°ç¬¬äºŒä¸ª `commit` å†™é”™äº†ï¼Œæ€ä¹ˆåŠï¼Ÿ

å¦‚æœä¸æ˜¯æœ€æ–°çš„ `commit` å†™é”™ï¼Œå°±ä¸èƒ½ç”¨ `commit --amend` æ¥ä¿®å¤äº†ï¼Œè€Œæ˜¯è¦ç”¨ `rebase`ã€‚ä¸è¿‡éœ€è¦ç»™ `rebase` ä¹ŸåŠ ä¸€ä¸ªå‚æ•°ï¼š`-i`ã€‚

`rebase -i` æ˜¯ `rebase --interactive` çš„ç¼©å†™å½¢å¼ï¼Œæ„ä¸ºã€Œäº¤äº’å¼ rebaseã€ã€‚

æ‰€è°“ã€Œäº¤äº’å¼ rebaseã€ï¼Œå°±æ˜¯åœ¨ `rebase` çš„æ“ä½œæ‰§è¡Œä¹‹å‰ï¼Œä½ å¯ä»¥æŒ‡å®šè¦ `rebase` çš„ `commit` é“¾ä¸­çš„æ¯ä¸€ä¸ª `commit` æ˜¯å¦éœ€è¦è¿›ä¸€æ­¥ä¿®æ”¹ã€‚

é‚£ä¹ˆä½ å°±å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹ç‚¹ï¼Œè¿›è¡Œä¸€æ¬¡ã€ŒåŸåœ° rebaseã€ã€‚

ä¾‹å¦‚ä½ æ˜¯åœ¨å†™é”™äº† `commit` ä¹‹åï¼Œåˆæäº¤äº†ä¸€æ¬¡æ‰å‘ç°ä¹‹å‰å†™é”™äº†ï¼š

```shell
$ git log
```

![img](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2017/11/22/15fdf5fd00a27f45~tplv-t2oaga2asx-zoom-in-crop-mark:3024:0:0:0.awebp)

ç°åœ¨å†ç”¨ `commit --amend` å·²ç»æ™šäº†ï¼Œä½†å¯ä»¥ç”¨ `rebase -i`ï¼š

```shell
$ git rebase -i HEAD^^
```

> è¯´æ˜ï¼šåœ¨ Git ä¸­ï¼Œæœ‰ä¸¤ä¸ªã€Œåç§»ç¬¦å·ã€ï¼š `^` å’Œ `~`ã€‚
>
> `^` çš„ç”¨æ³•ï¼šåœ¨ `commit` çš„åé¢åŠ ä¸€ä¸ªæˆ–å¤šä¸ª `^` å·ï¼Œå¯ä»¥æŠŠ `commit` å¾€å›åç§»ï¼Œåç§»çš„æ•°é‡æ˜¯ `^` çš„æ•°é‡ã€‚ä¾‹å¦‚ï¼š`master^` è¡¨ç¤º `master` æŒ‡å‘çš„ `commit` ä¹‹å‰çš„é‚£ä¸ª `commit`ï¼› `HEAD^^` è¡¨ç¤º `HEAD` æ‰€æŒ‡å‘çš„ `commit` å¾€å‰æ•°ä¸¤ä¸ª `commit`ã€‚
>
> `~` çš„ç”¨æ³•ï¼šåœ¨ `commit` çš„åé¢åŠ ä¸Š `~` å·å’Œä¸€ä¸ªæ•°ï¼Œå¯ä»¥æŠŠ `commit` å¾€å›åç§»ï¼Œåç§»çš„æ•°é‡æ˜¯ `~` å·åé¢çš„æ•°ã€‚ä¾‹å¦‚ï¼š`HEAD~5` è¡¨ç¤º `HEAD` æŒ‡å‘çš„ `commit`å¾€å‰æ•° 5 ä¸ª `commit`ã€‚

ä¸Šé¢è¿™è¡Œä»£ç è¡¨ç¤ºï¼ŒæŠŠå½“å‰ `commit` ï¼ˆ `HEAD` æ‰€æŒ‡å‘çš„ `commit`ï¼‰ `rebase` åˆ° `HEAD` ä¹‹å‰ 2 ä¸ªçš„ `commit` ä¸Šï¼š

![img](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2017/11/22/15fdf5fd00522381~tplv-t2oaga2asx-zoom-in-crop-mark:3024:0:0:0.awebp)

å¦‚æœæ²¡æœ‰ `-i` å‚æ•°çš„è¯ï¼Œè¿™ç§ã€ŒåŸåœ° rebaseã€ç›¸å½“äºç©ºæ“ä½œï¼Œä¼šç›´æ¥ç»“æŸã€‚è€Œåœ¨åŠ äº† `-i` åï¼Œå°±ä¼šè·³åˆ°ä¸€ä¸ªæ–°çš„ç•Œé¢ï¼š

![img](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2017/11/22/15fdf5fd04f46d6e~tplv-t2oaga2asx-zoom-in-crop-mark:3024:0:0:0.awebp)

æŠŠ `pick` ä¿®æ”¹æˆ `edit` åï¼Œå°±å¯ä»¥é€€å‡ºç¼–è¾‘ç•Œé¢äº†ï¼š

![img](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2017/11/22/15fdf5fd007159fa~tplv-t2oaga2asx-zoom-in-crop-mark:3024:0:0:0.awebp)

ä¸Šå›¾çš„æç¤ºä¿¡æ¯è¯´æ˜ï¼Œ`rebase` è¿‡ç¨‹å·²ç»åœåœ¨äº†ç¬¬äºŒä¸ª `commit` çš„ä½ç½®ï¼Œé‚£ä¹ˆç°åœ¨ä½ å°±å¯ä»¥å»ä¿®æ”¹ä½ æƒ³ä¿®æ”¹çš„å†…å®¹äº†ã€‚

ä¿®æ”¹å®Œæˆä¹‹åï¼Œå’Œä¸ŠèŠ‚é‡Œçš„æ–¹æ³•ä¸€æ ·ï¼Œç”¨ `commit --amend` æ¥æŠŠä¿®æ­£åº”ç”¨åˆ°å½“å‰æœ€æ–°çš„ `commit`ï¼š

```shell
$ git add ç¬‘å£°
$ git commit --amend
```

![img](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2017/11/22/15fdf5fd04de0d40~tplv-t2oaga2asx-zoom-in-crop-mark:3024:0:0:0.awebp)

åœ¨ä¿®å¤å®Œæˆä¹‹åï¼Œå°±å¯ä»¥ç”¨ `rebase --continue` æ¥ç»§ç»­ `rebase` è¿‡ç¨‹ï¼ŒæŠŠåé¢çš„ `commit` ç›´æ¥åº”ç”¨ä¸Šå»ã€‚

```shell
$ git rebase --continue
```

![img](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2017/11/22/15fdf5fd54455c29~tplv-t2oaga2asx-zoom-in-crop-mark:3024:0:0:0.awebp)

ç„¶åï¼Œè¿™æ¬¡äº¤äº’å¼ `rebase` çš„è¿‡ç¨‹å°±å®Œç¾ç»“æŸäº†ï¼Œä½ çš„é‚£ä¸ªå€’æ•°ç¬¬äºŒä¸ªå†™é”™çš„ `commit` å°±ä¹Ÿè¢«ä¿®æ­£äº†ï¼š

![img](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2017/11/22/15fdf5fd4e7d5257~tplv-t2oaga2asx-zoom-in-crop-mark:3024:0:0:0.awebp)

å®è´¨ä¸Šï¼Œäº¤äº’å¼ `rebase` å¹¶ä¸æ˜¯å¿…é¡»åº”ç”¨åœ¨ã€ŒåŸåœ° rebaseã€ä¸Šæ¥ä¿®æ”¹å†™é”™çš„ `commit` ï¼Œè¿™åªä¸è¿‡æ˜¯å®ƒæœ€å¸¸è§çš„ç”¨æ³•ã€‚ä½ åŒæ ·ä¹Ÿå¯ä»¥æŠŠå®ƒç”¨åœ¨åˆ†å‰çš„ `commit` ä¸Šï¼Œä¸è¿‡è¿™ä¸ªä½ å°±å¯ä»¥è‡ªå·±å»ç ”ç©¶ä¸€ä¸‹äº†ã€‚

## ä¸¢å¼ƒå€’æ•°ç¬¬äºŒä¸ªæäº¤ | å¼ºå¤§çš„ rebase

å¦‚æœè¦ä¸¢å¼ƒåˆšæäº¤çš„ `commit`ï¼Œé‚£åªéœ€è¦æ‰§è¡Œ `git reset --hard HEAD^` å³å¯ï¼Œé‚£å¦‚æœæ˜¯å€’äºŒä¸ªå‘¢ï¼Ÿ

### `git rebase -i`

```shell
$ git rebase -i HEAD^^
# ä¸Šæ–‡æ˜¯ä¿®æ”¹ pick ä¸º editï¼›è€Œè¯¥æ“ä½œåªéœ€è¦å°† pick å½“è¡Œåˆ é™¤å³å¯
```

### `git rebase --onto`

é™¤äº†ç”¨äº¤äº’å¼ `rebase` ï¼Œä½ è¿˜å¯ä»¥ç”¨ `rebase --onto` æ¥æ›´ç®€ä¾¿åœ°æ’¤é”€æäº¤ã€‚

`rebase` åŠ ä¸Š `--onto` é€‰é¡¹ä¹‹åï¼Œå¯ä»¥æŒ‡å®š `rebase` çš„ã€Œèµ·ç‚¹ã€ã€‚ä¸€èˆ¬çš„ `rebase`ï¼Œå‘Šè¯‰ Git çš„æ˜¯ã€Œæˆ‘è¦æŠŠå½“å‰ `commit` ä»¥åŠå®ƒä¹‹å‰çš„ `commit`s é‡æ–°æäº¤åˆ°ç›®æ ‡ `commit` ä¸Šå»ï¼Œè¿™å…¶ä¸­ï¼Œ`rebase` çš„ã€Œèµ·ç‚¹ã€æ˜¯è‡ªåŠ¨åˆ¤å®šçš„ï¼šé€‰å–å½“å‰ `commit` å’Œç›®æ ‡ `commit` åœ¨å†å²ä¸Šçš„äº¤å‰ç‚¹ä½œä¸ºèµ·ç‚¹ã€‚

ä¾‹å¦‚ä¸‹é¢è¿™ç§æƒ…å†µï¼š

![img](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2017/11/22/15fe24400508e3c8~tplv-t2oaga2asx-zoom-in-crop-mark:3024:0:0:0.awebp)

å¦‚æœåœ¨è¿™é‡Œæ‰§è¡Œï¼š

```shell
$ git rebase <ç¬¬3ä¸ªcommit>
```

é‚£ä¹ˆ Git ä¼šè‡ªåŠ¨é€‰å– `3` å’Œ `5` çš„å†å²äº¤å‰ç‚¹ `2` ä½œä¸º `rebase` çš„èµ·ç‚¹ï¼Œä¾æ¬¡å°† `4` å’Œ `5` é‡æ–°æäº¤åˆ° `3` çš„è·¯å¾„ä¸Šå»ã€‚

è€Œ `--onto` å‚æ•°ï¼Œå°±å¯ä»¥é¢å¤–ç»™ rebase æŒ‡å®šå®ƒçš„èµ·ç‚¹ã€‚ä¾‹å¦‚åŒæ ·ä»¥ä¸Šå›¾ä¸ºä¾‹ï¼Œå¦‚æœæˆ‘åªæƒ³æŠŠ `5` æäº¤åˆ° `3` ä¸Šï¼Œä¸æƒ³é™„å¸¦ä¸Š `4`ï¼Œé‚£ä¹ˆæˆ‘å¯ä»¥æ‰§è¡Œï¼š

```shell
$ git rebase --onto <ç¬¬3ä¸ªcommit> <ç¬¬4ä¸ªcommit> branch1
```

`--onto` å‚æ•°åé¢æœ‰ä¸‰ä¸ªé™„åŠ å‚æ•°ï¼šç›®æ ‡ `commit`ã€èµ·ç‚¹ `commit`ï¼ˆæ³¨æ„ï¼šrebase çš„æ—¶å€™ä¼šæŠŠèµ·ç‚¹æ’é™¤åœ¨å¤–ï¼‰ã€ç»ˆç‚¹ `commit`ã€‚æ‰€ä»¥ä¸Šé¢è¿™è¡ŒæŒ‡ä»¤å°±ä¼šä» `4` å¾€ä¸‹æ•°ï¼Œæ‹¿åˆ° `branch1` æ‰€æŒ‡å‘çš„ `5`ï¼Œç„¶åæŠŠ `5` é‡æ–°æäº¤åˆ° `3` ä¸Šå»ã€‚

![img](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2017/11/22/15fe24400d7d73d0~tplv-t2oaga2asx-zoom-in-crop-mark:3024:0:0:0.awebp)

```shell
$ git rebase --onto HEAD^^ HEAD^ branch1
```

ä¸Šé¢è¿™è¡Œä»£ç çš„æ„æ€æ˜¯ï¼šä»¥å€’æ•°ç¬¬äºŒä¸ª `commit` ä¸ºèµ·ç‚¹ï¼ˆèµ·ç‚¹ä¸åŒ…å«åœ¨ `rebase` åºåˆ—é‡Œå“Ÿï¼‰ï¼Œ`branch1` ä¸ºç»ˆç‚¹ï¼Œ`rebase` åˆ°å€’æ•°ç¬¬ä¸‰ä¸ª `commit` ä¸Šã€‚

ä¹Ÿå°±æ˜¯è¿™æ ·ï¼š

![img](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2017/11/22/15fe243fce5804fd~tplv-t2oaga2asx-zoom-in-crop-mark:3024:0:0:0.awebp)

## reset çš„æœ¬è´¨ | å‚æ•°è§£æ

`reset` çš„ä¸‰ç§å‚æ•°ï¼š

1. `--hard`ï¼šé‡ç½®ä½ç½®çš„åŒæ—¶ï¼Œ**æ¸…ç©ºå·¥ä½œç›®å½•çš„æ‰€æœ‰æ”¹åŠ¨**ï¼›
2. `--soft`ï¼šé‡ç½®ä½ç½®çš„åŒæ—¶ï¼Œ**ä¿ç•™å·¥ä½œç›®å½•å’Œæš‚å­˜åŒºçš„å†…å®¹**ï¼Œå¹¶æŠŠé‡ç½® `HEAD` çš„ä½ç½®æ‰€å¯¼è‡´çš„æ–°çš„æ–‡ä»¶å·®å¼‚æ”¾è¿›æš‚å­˜åŒºã€‚
3. `--mixed`ï¼ˆé»˜è®¤ `git reset`ï¼‰ï¼šé‡ç½®ä½ç½®çš„åŒæ—¶ï¼Œ**ä¿ç•™å·¥ä½œç›®å½•çš„å†…å®¹ï¼Œå¹¶æ¸…ç©ºæš‚å­˜åŒº**ã€‚

## checkout çš„æœ¬è´¨ | é™¤äº†åˆ‡æ¢åˆ†æ”¯è¿˜å¯ç­¾å‡ºæŸä¸ªæäº¤

ä¸è¿‡å®è´¨ä¸Šï¼Œ`checkout` å¹¶ä¸æ­¢å¯ä»¥åˆ‡æ¢ `branch`ã€‚`checkout` æœ¬è´¨ä¸Šçš„åŠŸèƒ½å…¶å®æ˜¯ï¼šç­¾å‡ºï¼ˆ checkout ï¼‰æŒ‡å®šçš„ `commit`ã€‚

ç›´æ¥ä¸Šæ¡ˆä¾‹ï¼š

```shell
$ git checkout HEAD^^
$ git checkout master~5
$ git checkout <SHA>
$ git checkout <SHA>^^^
```

å¦å¤–ï¼Œå¦‚æœä½ ç•™å¿ƒçš„è¯å¯èƒ½ä¼šå‘ç°ï¼Œåœ¨ `git status` çš„æç¤ºè¯­ä¸­ï¼ŒGit ä¼šå‘Šè¯‰ä½ å¯ä»¥ç”¨ `checkout -- æ–‡ä»¶å` çš„æ ¼å¼ï¼Œé€šè¿‡ã€Œç­¾å‡ºã€çš„æ–¹å¼æ¥æ’¤é”€æŒ‡å®šæ–‡ä»¶çš„ä¿®æ”¹ï¼š

> **å³æ’¤é”€å·¥ä½œç›®å½•ä¸‹çš„ä¿®æ”¹**ï¼ˆæ­¤æ—¶æœªæ·»åŠ åˆ°æš‚å­˜åŒºï¼‰

![img](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2017/11/22/15fe34cc387ba541~tplv-t2oaga2asx-zoom-in-crop-mark:3024:0:0:0.awebp)

## Emergencyï¼æ”¾ä¸‹ä½ æ‰‹ä¸Šçš„å·¥ä½œ | stash ä¸´æ—¶å­˜æ”¾å·¥ä½œç›®å½•å˜åŠ¨

"stash" è¿™ä¸ªè¯ï¼Œå’Œå®ƒæ„æ€æ¯”è¾ƒæ¥è¿‘çš„ä¸­æ–‡ç¿»è¯‘æ˜¯ã€Œè—åŒ¿ã€ï¼Œæ˜¯ã€ŒæŠŠä¸œè¥¿æ”¾åœ¨ä¸€ä¸ªç§˜å¯†çš„åœ°æ–¹ä»¥å¤‡æœªæ¥ä½¿ç”¨ã€çš„æ„æ€ã€‚åœ¨ Git ä¸­ï¼Œ`stash` æŒ‡ä»¤å¯ä»¥å¸®ä½ æŠŠå·¥ä½œç›®å½•çš„å†…å®¹å…¨éƒ¨æ”¾åœ¨ä½ æœ¬åœ°çš„ä¸€ä¸ªç‹¬ç«‹çš„åœ°æ–¹ï¼Œå®ƒä¸ä¼šè¢«æäº¤ï¼Œä¹Ÿä¸ä¼šè¢«åˆ é™¤ï¼Œä½ æŠŠä¸œè¥¿æ”¾èµ·æ¥ä¹‹åå°±å¯ä»¥å»åšä½ çš„ä¸´æ—¶å·¥ä½œäº†ï¼Œåšå®Œä»¥åå†æ¥å–èµ°ï¼Œå°±å¯ä»¥ç»§ç»­ä¹‹å‰æ‰‹å¤´çš„äº‹äº†ã€‚

å…·ä½“è¯´æ¥ï¼Œ`stash` çš„ç”¨æ³•å¾ˆç®€å•ã€‚å½“ä½ æ‰‹å¤´æœ‰ä¸€ä»¶ä¸´æ—¶å·¥ä½œè¦åšï¼Œéœ€è¦æŠŠå·¥ä½œç›®å½•æš‚æ—¶æ¸…ç†å¹²å‡€ï¼Œé‚£ä¹ˆä½ å¯ä»¥ï¼š

```shell
$ git stash
```

å°±è¿™ä¹ˆç®€å•ï¼Œä½ çš„å·¥ä½œç›®å½•çš„æ”¹åŠ¨å°±è¢«æ¸…ç©ºäº†ï¼Œæ‰€æœ‰æ”¹åŠ¨éƒ½è¢«å­˜äº†èµ·æ¥ã€‚

ç„¶åä½ å°±å¯ä»¥ä»ä½ å½“å‰çš„å·¥ä½œåˆ†æ”¯åˆ‡åˆ° `master` å»ç»™ä½ çš„åŒäº‹æ‰“åŒ…äº†â€¦â€¦

æ‰“å®ŒåŒ…ï¼Œåˆ‡å›ä½ çš„åˆ†æ”¯ï¼Œç„¶åï¼š

```shell
$ git stash pop
```

ä½ ä¹‹å‰å­˜å‚¨çš„ä¸œè¥¿å°±éƒ½å›æ¥äº†ã€‚å¾ˆæ–¹ä¾¿å§ï¼

> æ³¨æ„ï¼šæ²¡æœ‰è¢« track çš„æ–‡ä»¶ï¼ˆå³ä»æ¥æ²¡æœ‰è¢« add è¿‡çš„æ–‡ä»¶ä¸ä¼šè¢« stash èµ·æ¥ï¼Œå› ä¸º Git ä¼šå¿½ç•¥å®ƒä»¬ã€‚å¦‚æœæƒ³æŠŠè¿™äº›æ–‡ä»¶ä¹Ÿä¸€èµ· stashï¼Œå¯ä»¥åŠ ä¸Š `-u` å‚æ•°ï¼Œå®ƒæ˜¯ `--include-untracked` çš„ç®€å†™ã€‚å°±åƒè¿™æ ·ï¼š
>
> ```shell
> $ git stash -u
> ```

## ä»æš‚å­˜åŒºæ’¤å›å·¥ä½œç›®å½• | restore

> use `git restore --staged <file>` to unstage

å¦‚æœå·²ç»å°†æ–‡ä»¶æ·»åŠ åˆ°æš‚å­˜åŒºï¼Œç„¶åæƒ³è¦æ’¤é”€æš‚å­˜åŒºä¸­è¯¥æ–‡ä»¶çš„å†…å®¹ï¼ˆæ‰“å›å·¥ä½œç›®å½•ï¼‰ï¼Œåˆ™ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š

```shell
$ git restore --staged <file>
```

> tipï¼šå¦‚æœæ–‡ä»¶åœ¨å·¥ä½œç›®å½•ä¸‹ä¿®æ”¹è¿‡ä½†æœªæ·»åŠ åˆ°æš‚å­˜åŒºï¼Œåˆ™é€šè¿‡å‰æ–‡æåˆ°çš„ `git checkout -- <file>` æ¥æ’¤é”€è¯¥ä¿®æ”¹ã€‚

## æ‰¾å›ä¸¢å¤±çš„ branch | reflog

`reflog` æ˜¯ "reference log" çš„ç¼©å†™ï¼Œä½¿ç”¨å®ƒå¯ä»¥æŸ¥çœ‹ Git ä»“åº“ä¸­çš„å¼•ç”¨çš„ç§»åŠ¨è®°å½•ã€‚å¦‚æœä¸æŒ‡å®šå¼•ç”¨ï¼Œå®ƒä¼šæ˜¾ç¤º `HEAD` çš„ç§»åŠ¨è®°å½•ã€‚å‡å¦‚ä½ è¯¯åˆ äº† `branch1` è¿™ä¸ª `branch`ï¼Œé‚£ä¹ˆä½ å¯ä»¥æŸ¥çœ‹ä¸€ä¸‹ `HEAD` çš„ç§»åŠ¨å†å²ï¼š

```shell
$ git reflog
```

![](https://cdn.jsdelivr.net/gh/Wu-yikun/OSS/PicGo/202305291053387.png)

ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œ`HEAD` çš„æœ€åä¸€æ¬¡ç§»åŠ¨è¡Œä¸ºæ˜¯ã€Œä» `branch1` ç§»åŠ¨åˆ° `master`ã€ã€‚è€Œåœ¨è¿™ä¹‹åï¼Œ`branch1` å°±è¢«åˆ é™¤äº†ã€‚æ‰€ä»¥å®ƒä¹‹å‰çš„é‚£ä¸ª `commit` å°±æ˜¯ `branch1` è¢«åˆ é™¤ä¹‹å‰çš„ä½ç½®äº†ï¼Œä¹Ÿå°±æ˜¯ç¬¬äºŒè¡Œçš„ `c08de9a`ã€‚

æ‰€ä»¥ç°åœ¨å°±å¯ä»¥åˆ‡æ¢å› `c08de9a`ï¼Œç„¶åé‡æ–°åˆ›å»º `branch1` ï¼š

```shell
$ git checkout -b branch1
```

è¿™æ ·ï¼Œä½ åˆšåˆ é™¤çš„ `branch1` å°±æ‰¾å›æ¥äº†ã€‚

> æ³¨æ„ï¼šä¸å†è¢«å¼•ç”¨ç›´æ¥æˆ–é—´æ¥æŒ‡å‘çš„ `commit`s ä¼šåœ¨ä¸€å®šæ—¶é—´åè¢« Git å›æ”¶ï¼Œæ‰€ä»¥ä½¿ç”¨ `reflog` æ¥æ‰¾å›åˆ é™¤çš„ `branch` çš„æ“ä½œä¸€å®šè¦åŠæ—¶ï¼Œä¸ç„¶æœ‰å¯èƒ½ä¼šç”±äº `commit` è¢«å›æ”¶è€Œå†ä¹Ÿæ‰¾ä¸å›æ¥ã€‚

---

`reflog` é»˜è®¤æŸ¥çœ‹ `HEAD` çš„ç§»åŠ¨å†å²ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨åŠ ä¸Šåˆ†æ”¯åç§°æŸ¥çœ‹å…¶ä»–åˆ†æ”¯çš„å¼•ç”¨ç§»åŠ¨å†å²ï¼Œä¾‹å¦‚ `master` åˆ†æ”¯ï¼š

```shell
$ git reflog master
```

![](https://cdn.jsdelivr.net/gh/Wu-yikun/OSS/PicGo/202305291056201.png)

## ä¸å¯ç§»åŠ¨çš„ branch | tag

`tag` æ˜¯ä¸€ä¸ªå’Œ `branch` éå¸¸ç›¸ä¼¼çš„æ¦‚å¿µï¼Œå®ƒå’Œ `branch` æœ€å¤§çš„åŒºåˆ«æ˜¯ï¼š`tag` ä¸èƒ½ç§»åŠ¨ã€‚æ‰€ä»¥åœ¨å¾ˆå¤šå›¢é˜Ÿä¸­ï¼Œ`tag` è¢«ç”¨æ¥åœ¨å…³é”®ç‰ˆæœ¬å¤„æ‰“æ ‡è®°ç”¨ã€‚

æ›´å¤šå…³äº `tag`ï¼š[git-scm.com/docs/git-taâ€¦](https://git-scm.com/docs/git-tag)

## Git Flowï¼šå¤æ‚åˆé«˜æ•ˆçš„å·¥ä½œæµ

é™¤äº†å‰é¢è®²åˆ°çš„ "Feature Branching"ï¼Œè¿˜æœ‰ä¸€ä¸ªä¹Ÿå¾ˆæµè¡Œçš„å·¥ä½œæµï¼šGit Flowã€‚Git Flow çš„æœºåˆ¶éå¸¸å®Œå–„ï¼Œå¾ˆé€‚åˆå¤§å‹å›¢é˜Ÿçš„ä»£ç ç®¡ç†ã€‚ä¸è¿‡ç”±äºå®ƒçš„æ¦‚å¿µæ¯”è¾ƒå¤æ‚ï¼ˆè™½ç„¶éš¾åº¦å¹¶ä¸é«˜ï¼‰ï¼Œæ‰€ä»¥å¹¶ä¸é€‚åˆæ–°æ‰‹ç›´æ¥å­¦ä¹ ï¼Œè€Œæ›´é€‚åˆåœ¨ä¸æ–­çš„è‡ªæˆ‘ç ”ç©¶ä¸­é€æ¸ç†Ÿæ‚‰ï¼Œæˆ–è€…åœ¨å›¢é˜Ÿåˆä½œä¸­æ…¢æ…¢æŒæ¡ã€‚åŸºäºè¿™ä¸ªåŸå› ï¼Œæˆ‘æœ€ç»ˆä¹Ÿæ²¡æœ‰åœ¨è¿™æœ¬å°å†Œé‡Œè®² Git Flowï¼Œä½†æˆ‘æ¨èä½ è‡ªå·±åœ¨æœ‰ç©ºçš„æ—¶å€™äº†è§£ä¸€ä¸‹å®ƒã€‚