---
title: C++ ACM æ¨¡å¼
description: å½’çº³ C++ çš„ ACM è¾“å…¥è¾“å‡ºå¸¸è§åœºæ™¯ä¸å„æ•°æ®ç±»å‹çš„æ„é€ æ–¹å¼ï¼Œå¸¸è§äºã€Œé¢è¯•æ‰‹æ’•ã€ä¸ã€Œç¬”è¯•ã€
publishDate: 2025-04-27
tags: [ç§‹æ‹›æŒ‡å—]
heroImage: { src: ../_img/202507201320470.png }
language: Chinese
comment: true
draft: false
---

âœ… åä¸ºæ ¡æ‹›æœºè€ƒå¤‡è€ƒé¢˜å•ï¼šhttps://rttxvuqg3f.feishu.cn/docx/PcBHdy3GsoIhxnx1RqucVqRdnAf

## C++ ACM æ¨¡å¼è¾“å…¥è¾“å‡º

### 1. è¾“å…¥è¾“å‡ºçš„ç›¸å…³åº“å‡½æ•°

#### 1ï¸âƒ£ è¾“å‡ºæ ¼å¼åŒ–ï¼ˆç²¾åº¦ï¼‰

C++ æä¾›äº†å¤šç§æ–¹å¼æ¥æ§åˆ¶è¾“å…¥è¾“å‡ºçš„æ ¼å¼ï¼Œå¸¸ç”¨çš„åŒ…æ‹¬ `std::setw`ã€`std::setprecision`ã€`std::fixed` ç­‰ã€‚

```cpp
#include <iostream>
#include <iomanip>  // æä¾›æ ¼å¼åŒ–å·¥å…·

int main() {
    double pi = 3.14159265358979;
    
    std::cout << "åŸå§‹å€¼: " << pi << std::endl;

    // è®¾ç½®è¾“å‡ºç²¾åº¦ä¸º 2 ä½å°æ•°
    std::cout << "ä¿ç•™ä¸¤ä½å°æ•°: " << std::fixed << std::setprecision(2) << pi << std::endl;
    return 0;
}
```

#### 2ï¸âƒ£ cin

`cin` æ˜¯æ ‡å‡†è¾“å…¥æµå¯¹è±¡ï¼Œé€šå¸¸ç”¨äºä»ç”¨æˆ·é‚£é‡Œè¯»å–æ•°æ®ã€‚å½“æˆ‘ä»¬ç”¨ `while (cin)` æ¥è¯»å–è¾“å…¥æ—¶ï¼Œå®ƒçš„å·¥ä½œåŸç†æ˜¯ä¸æ–­æ£€æŸ¥è¾“å…¥æµæ˜¯å¦æœ‰æ•ˆã€‚å¦‚æœç”¨æˆ·è¾“å…¥äº†æ•°æ®å¹¶ä¸”æ²¡æœ‰é‡åˆ°é”™è¯¯æˆ–è€…æ–‡ä»¶ç»“æŸæ ‡å¿—ï¼ˆä¾‹å¦‚ `Ctrl+Z` æˆ– `Ctrl+D` è¡¨ç¤º EOFï¼‰ï¼Œé‚£ä¹ˆ `cin` å°±ä¼šç»§ç»­è¯»å–å¹¶è¿›å…¥å¾ªç¯ã€‚

æ³¨æ„ï¼Œ`cin >> val` ä¼šä¸€ç›´ä» **æ ‡å‡†è¾“å…¥æµ** ä¸­è¯»å–æ•°æ®ï¼Œ**ä»¥ç©ºç™½å­—ç¬¦ä¸ºåˆ†éš”ç¬¦**ï¼ŒåŒ…æ‹¬ï¼š

- ç©ºæ ¼ `' '`
- å›è½¦ `'\n'`
- åˆ¶è¡¨ç¬¦ `'\t'`

è¿™äº›éƒ½æ˜¯åˆ†éš”ç¬¦ï¼Œä½† **ä¸ä¼šç»ˆæ­¢è¾“å…¥æµ**ï¼Œåªæ˜¯åˆ’åˆ†è¾“å…¥çš„ä¸åŒéƒ¨åˆ†ã€‚

#### 3ï¸âƒ£ stringstream

`std::stringstream` æ˜¯ C++ æ ‡å‡†åº“ä¸­çš„ä¸€ä¸ªç±»ï¼Œä½äº `<sstream>` å¤´æ–‡ä»¶ä¸­ã€‚å®ƒæä¾›äº†ä¸€ä¸ªç”¨äºåœ¨å†…å­˜ä¸­è¿›è¡Œè¾“å…¥è¾“å‡ºæ“ä½œçš„å­—ç¬¦ä¸²æµã€‚`std::stringstream` å…è®¸ä½ åƒä½¿ç”¨ `std::cin` å’Œ `std::cout` ä¸€æ ·æ“ä½œå­—ç¬¦ä¸²ï¼Œå®ƒå¯ä»¥ç”¨æ¥ä»å­—ç¬¦ä¸²ä¸­è¯»å–æ•°æ®ï¼Œæˆ–å°†æ•°æ®å†™å…¥åˆ°å­—ç¬¦ä¸²ä¸­ã€‚å®ƒçš„ä¸»è¦ç”¨é€”æ˜¯è¿›è¡Œå­—ç¬¦ä¸²çš„æ ¼å¼åŒ–å’Œæ•°æ®çš„è½¬æ¢ã€‚

`std::stringstream` ç»§æ‰¿è‡ª `std::iostream`ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ `<<` å’Œ `>>` è¿ç®—ç¬¦æ¥è¿›è¡Œæ•°æ®æµçš„è¾“å…¥è¾“å‡ºã€‚å¦‚æœæƒ³æ¸…ç©º `stringstream` ä¸­çš„æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ `str("")` æ–¹æ³•ï¼Œå°†æµçš„å†…å®¹è®¾ç½®ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œæˆ–è€…ä½¿ç”¨ `clear()` æ¥é‡ç½®æµçš„çŠ¶æ€ã€‚

```cpp
#include <iostream>
#include <sstream>

int main() {
    std::stringstream ss1;
    int x = 10;
    double y = 3.14;
    ss1 << "Integer: " << x << ", Double: " << y;
    std::cout << ss.str() << std::endl;
    
    std::stringstream ss2("123 456 3.14");
    int a, b;
    double c;
    ss >> a >> b >> c;
    std::cout << "a: " << a << ", b: " << b << ", c: " << c << std::endl;
    
    // æ¸…ç©º: ss.str("")
    ss1.str("");
}
```

#### 4ï¸âƒ£ getline

`getline` å‡½æ•°æ˜¯ C++ ä¸­ç”¨äºä»è¾“å…¥æµä¸­è¯»å–ä¸€è¡Œæ–‡æœ¬çš„å‡½æ•°ï¼Œé€šå¸¸ç”¨äºè¯»å–ç”¨æˆ·è¾“å…¥æˆ–æ–‡ä»¶ä¸­çš„ä¸€è¡Œæ•°æ®ã€‚å®ƒçš„åŸºæœ¬ç”¨æ³•æ˜¯ï¼šè¯»å–ä¸€æ•´è¡Œæ•°æ®ï¼Œç›´åˆ°é‡åˆ°æ¢è¡Œç¬¦ï¼ˆ`\n`ï¼‰ä¸ºæ­¢ã€‚å®ƒä¸ä¼šå°†æ¢è¡Œç¬¦åŒ…å«åœ¨è¿”å›çš„å­—ç¬¦ä¸²ä¸­ã€‚å‡½æ•°åŸå‹ä¸ºï¼š

```cpp
istream& getline (istream& is, string& str);
```

å®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼š

1. `is`ï¼šè¾“å…¥æµå¯¹è±¡ï¼ˆå¦‚ `cin` æˆ– `ifstream`ï¼‰ã€‚
2. `str`ï¼šå­˜å‚¨è¯»å–å†…å®¹çš„ `string` å¯¹è±¡ã€‚

```cpp
#include <iostream>
#include <string>
using namespace std;

int main() {
    // è¾“å…¥ 1 2 3 4
    string line;
    while (getline(cin, line)) {
        cout << "è¾“å…¥çš„è¡Œæ˜¯: " << line << endl;
    }
    return 0;
}
```

```cpp
#include <iostream>
#include <string>
using namespace std;

int main() {
    std::string input;
    std::cin >> input;  // è¾“å…¥ 1,2,3,4

    std::stringstream ss(input);
    std::vector<int> nums;
    std::string number;
	// stringstream, string
    while (getline(ss, number, ',')) {
        nums.push_back(std::stoi(number));
    }
    return 0;
}
```

### 2. A+B+C+...ï¼ˆå•è¡Œè¾“å…¥ç‰ˆï¼‰

è¾“å…¥æ ·ä¾‹ï¼š

```
1 2 3 4 5
```

è¾“å‡ºæ ·ä¾‹ï¼š

```
15
```

é¢˜è§£ï¼š

```cpp
#include <bits/stdc++.h>
using namespace std;

int main() {
  // æ•°æ®èŒƒå›´: -10^9 <= x <= 10^9
  long long val, s = 0;
  while (cin >> val) {
    s += val;
  }
  cout << s << endl;
  return 0;
}
```

### 3. A+B+C+...ï¼ˆå¤šè¡Œè¾“å…¥ç‰ˆï¼‰

è¾“å…¥æ ·ä¾‹ï¼š

```cpp
1 2 3
4 5 6 7
8 9
```

è¾“å‡ºæ ·ä¾‹ï¼š

```cpp
6
22
17
```

é¢˜è§£ï¼š

```cpp
#include <iostream>
#include <sstream>
using namespace std;

int main() {
  string line;
  while (getline(cin, line)) { // æŒç»­è¯»å–å®Œæ•´ä¸€è¡Œï¼Œä¸€ç›´åˆ° EOF
    // ä½¿ç”¨ stringstream è§£ææ¯ä¸€è¡Œçš„è¾“å…¥
    // å‡è®¾è¯»åˆ°çš„æ˜¯"1 2 3"
    stringstream ss(line);
    long long num, sum = 0;
    while (ss >> num) { // é€ä¸ªè¯»å–è¿™ä¸€è¡Œçš„æ•´æ•°
      sum += num;       // å°†è¯»å–çš„æ•´æ•°ç´¯åŠ åˆ° sum ä¸­
                        // å…ˆæ˜¯sum += 1
                        // å†æ˜¯sum += 2
                        // æœ€åæ˜¯sum += 3
    }
    cout << sum << endl; // è¾“å‡ºè¿™ä¸€è¡Œæ‰€æœ‰æ•´æ•°çš„å’Œ : 6
  }
  return 0;
}
```

### ğŸ”¥ 4. A+B+C+...ï¼ˆå¸¦å…ƒç´ ä¸ªæ•°çš„å¤šè¡Œè¾“å…¥ç‰ˆï¼‰

è¾“å…¥ï¼š

```cpp
5 3
1 2 2 3 2
2
3
4
```

è¾“å‡ºï¼š

```cpp
3
1
0
```

âš ï¸ æœ¬é¢˜åè€Œè¦æ³¨æ„ï¼š`cin` ä¸æ˜¯è¯»åˆ° `\n` åœæ­¢ï¼Œè€Œæ˜¯ EOFï¼Œæ‰€ä»¥ line 14 ä¸èƒ½ç”¨ `while(cin >> val)` æ¥æ›¿ä»£ï¼Œå¦åˆ™åç»­å…ƒç´ éƒ½ä¼šè¢«å¸æ”¶åˆ° **nums** æ•°ç»„ä¸­ã€‚

```cpp
#include <algorithm>
#include <iostream>
#include <vector>
using namespace std;

int main() {
  ios::sync_with_stdio(false);
  cin.tie(nullptr);

  int n, Q;
  cin >> n >> Q;

  vector<int> nums(n);
  for (int i = 0; i < n; i++) {
    cin >> nums[i];
  }
  vector<int> query(Q);
  for (int i = 0; i < Q; i++) {
    cin >> query[i];
  }
  return 0;
}
```

æˆ–è€…å¯ä»¥ä½¿ç”¨ `cin.peek() != '\n'` æ­é… `cin >> val` ä½¿ç”¨ï¼ˆè¿™ä¸€åˆ»æˆ‘æ‰æ˜ç™½ `cin.peek()` ä¸ `cin.ignore()` çš„ä½œç”¨ï¼‰ï¼š

- è®°å¾—å…ˆå¤„ç†ä¸Šä¸€è¡Œçš„æœ«å°¾ï¼ˆå¦‚æœéœ€è¦å¤„ç†ï¼‰ï¼š`cin.ignore()` æˆ– `cin.get()`
- å†ä½¿ç”¨ `cin.peek() != '\n' & cin >> val` æ¥å¾ªç¯è¯»å–å½“å‰è¡Œå…ƒç´ 

```cpp
#include <algorithm>
#include <iostream>
#include <vector>
using namespace std;

int main() {
  ios::sync_with_stdio(false);
  cin.tie(nullptr);

  int n, Q;
  cin >> n >> Q;
  //vector<int> nums(n);
  //for (int i = 0; i < n; i++) {
  //  cin >> nums[i];
  //}
    
// ç­‰ä»·äº
    
  // ğŸ”¥æ³¨æ„è¿™é‡Œéœ€è¦å¤„ç†ç¬¬ä¸€è¡Œçš„ '\n', å› ä¸º cin >> n >> Q åè¿˜æ²¡è·³åˆ°ä¸‹ä¸€è¡Œã€‚
  cin.ignore();	// æˆ–è€… cin.get();
  vector<int> nums;
  int val;
  while (cin.peek() != '\n' && cin >> val) {
      nums.push_back(val);
  }
  vector<int> query(Q);
  for (int i = 0; i < Q; i++) {
    cin >> query[i];
  }
  return 0;
}
```

âš ï¸ **æ‹“å±•å»¶ä¼¸**

1ï¸âƒ£ ä¸Šè¿°çš„è¾“å…¥æ˜¯ï¼š

```
5 3â(æ¢è¡Œ)
1 2 2 3 2â(æ¢è¡Œ)
2â(æ¢è¡Œ)
3â(æ¢è¡Œ)
4â(æ¢è¡Œ)
```

2ï¸âƒ£ å‡è®¾è¾“å…¥å˜æˆä»¥ä¸‹è¿™ç§ï¼ˆå³ç¬¬äºŒè¡Œæ¢è¡Œç¬¦å‰è¿˜æœ‰ä¸€ä¸ªâ£(ç©ºæ ¼)ï¼‰ï¼š

```
5 3â(æ¢è¡Œ)
1 2 2 3 2â£(ç©ºæ ¼)â(æ¢è¡Œ)
2â(æ¢è¡Œ)
3â(æ¢è¡Œ)
4â(æ¢è¡Œ)
```

é‚£ nums çš„ä¸ªæ•°ä¼šæœ‰ 6 ä¸ªï¼Œå³ç¬¬ 3 è¡Œçš„ 2 ä¹Ÿä¼šå½“æˆ nums çš„å…ƒç´ ï¼Œå› ä¸º â£(ç©ºæ ¼) ä¸æ˜¯ `\n`ï¼Œæ‰€ä»¥ä¼šå†è§¦å‘ä¸€æ¬¡ `cin` æ“ä½œï¼Œæ‰€ä»¥å»ºè®®ä½¿ç”¨ `for (int i = 0; i < n; i++) { cin >> nums[i]; }` çš„æ–¹å¼æ›¿ä»£ `peek()` åˆ¤æ–­ï¼

## OJ æ—¶é—´å¤æ‚åº¦é™åˆ¶ä¸é¢„ä¼°

åœ¨ç¼–å†™ç¨‹åºæ—¶ï¼Œåˆ†æå…¶æ—¶é—´å¤æ‚åº¦ï¼ˆTime Complexityï¼‰æ˜¯è¯„ä¼°ç¨‹åºæ•ˆç‡çš„é‡è¦æ‰‹æ®µã€‚æ—¶é—´å¤æ‚åº¦æè¿°äº†ç¨‹åºè¿è¡Œæ—¶é—´ä¸è¾“å…¥è§„æ¨¡ä¹‹é—´çš„å…³ç³»ï¼Œé€šå¸¸ä½¿ç”¨å¤§Oç¬¦å·è¡¨ç¤ºï¼ˆå¦‚O(n)ã€O(nÂ²)ç­‰ï¼‰ã€‚ä¸‹é¢å°†è¯¦ç»†è§£é‡Šæ—¶é—´å¤æ‚åº¦çš„æ¦‚å¿µï¼Œå¹¶åˆ†æè¿™æ®µä»£ç çš„æ—¶é—´å¤æ‚åº¦ã€‚

ğŸ”¥ **OJ ä¸€èˆ¬ C++ 1ç§’ï¼ˆå³1000msï¼‰å¤§æ¦‚èƒ½è·‘ 1e8 é‡çº§**ï¼ˆå¾ˆå¤šé¢˜ç›®éƒ½ä¼šé™åˆ¶æ—¶é—´å’Œå†…å­˜ï¼Œå¦‚ä¸‹ï¼š

> æ—¶é—´é™åˆ¶: C/C++ 1000ms , å…¶ä»–è¯­è¨€ï¼š 2000ms
>
> å†…å­˜é™åˆ¶: C/C++ 256MB , å…¶ä»–è¯­è¨€ï¼š 512MB

```cpp
#include <iostream>
using namespace std;
int x;
int ans = 0;
int main() {
	cin>>x;
	for (int i = 1; i <= x; i++) {
		ans++;
	}
	cout<<ans;
	return 0;
}
```

ğŸ”¥å¯¹äºè¿™ä¸ªç®€å•çš„ä»£ç ï¼Œx < **1e8** , è¿è¡Œä¸ä¼šè¶…æ—¶ ï¼Œ x > **1e8** , è¿è¡Œè¶…æ—¶

âœ… æ—¶é—´å¤æ‚åº¦è¡¡é‡çš„æ˜¯ç®—æ³•æ‰§è¡Œæ‰€éœ€çš„æ—¶é—´å¢é•¿ç‡ï¼Œéšç€è¾“å…¥è§„æ¨¡çš„å¢åŠ ï¼Œç®—æ³•çš„è¿è¡Œæ—¶é—´å¦‚ä½•å˜åŒ–ã€‚å¸¸è§çš„æ—¶é—´å¤æ‚åº¦åŒ…æ‹¬ï¼š

- **O(1)**ï¼šå¸¸æ•°æ—¶é—´ï¼Œæ— è®ºè¾“å…¥è§„æ¨¡å¤šå¤§ï¼Œæ‰§è¡Œæ—¶é—´ä¿æŒä¸å˜ã€‚
- **O(log n)**ï¼šå¯¹æ•°æ—¶é—´ï¼Œéšç€è¾“å…¥è§„æ¨¡å¢åŠ ï¼Œæ‰§è¡Œæ—¶é—´æŒ‰å¯¹æ•°å¢é•¿ã€‚ä¾‹å¦‚äºŒåˆ†æ“ä½œã€‚
- **O(n)**ï¼šçº¿æ€§æ—¶é—´ï¼Œæ‰§è¡Œæ—¶é—´ä¸è¾“å…¥è§„æ¨¡æˆæ­£æ¯”ã€‚
- **O(n log n)**ï¼šçº¿æ€§å¯¹æ•°æ—¶é—´ï¼Œå¸¸è§äºé«˜æ•ˆæ’åºç®—æ³•å¦‚å¿«é€Ÿæ’åºã€å½’å¹¶æ’åºã€‚
- **O(nÂ²)**ï¼šå¹³æ–¹æ—¶é—´ï¼Œå¸¸è§äºç®€å•çš„åµŒå¥—å¾ªç¯ï¼Œå¦‚å†’æ³¡æ’åºã€‚

âœ… **å¦‚ä½•è®¡ç®—æ—¶é—´å¤æ‚åº¦**ï¼š

1. è¯†åˆ«åŸºæœ¬æ“ä½œï¼šç¡®å®šç®—æ³•ä¸­æœ€é¢‘ç¹æ‰§è¡Œçš„æ“ä½œï¼Œå¦‚å¾ªç¯ä¸­çš„è¯­å¥ã€é€’å½’è°ƒç”¨ç­‰ã€‚
2. è®¡ç®—åŸºæœ¬æ“ä½œçš„æ‰§è¡Œæ¬¡æ•°ï¼šæ ¹æ®è¾“å…¥è§„æ¨¡ï¼Œè®¡ç®—è¿™äº›æ“ä½œéšç€è¾“å…¥å¢é•¿çš„æ¬¡æ•°ã€‚
3. å¿½ç•¥ä½é˜¶é¡¹å’Œå¸¸æ•°ç³»æ•°ï¼šåœ¨å¤§Oè¡¨ç¤ºæ³•ä¸­ï¼Œåªä¿ç•™å¢é•¿æœ€å¿«çš„é¡¹ï¼Œå¿½ç•¥å¸¸æ•°å’Œä½é˜¶é¡¹ã€‚

ğŸ”¥ **å¯¹äºä¸€èˆ¬æƒ…å†µ**ï¼š

- n=$10^5$ æˆ– n=$10^6$ å·¦å³è€ƒè™‘ $O(n log n)$ ä»¥ä¸‹çš„åšæ³•
- n=$5 * 10^3$ å·¦å³è€ƒè™‘ $O(n^2)$ ä»¥ä¸‹çš„åšæ³•
- n=$10^2$ å·¦å³è€ƒè™‘ $O(n^3)$ ä»¥ä¸‹çš„åšæ³•
- n=$20$ å·¦å³è€ƒè™‘ $O(2^n)$ ä»¥ä¸‹çš„åšæ³•

## å„æ•°æ®ç±»å‹çš„è¯»å…¥ä¸æ„é€ 

### æ•°ç»„

```cpp
#include <bits/stdc++.h>
#include <numeric>
using namespace std;

int main() {
  int n;
  cin >> n;
  vector<int> nums(n);
  for (int i = 0; i < n; i++) {
    cin >> nums[i];
  }
  cout << accumulate(nums.begin(), nums.end(), 0) << endl;
  return 0;
}
```

### é“¾è¡¨

```cpp
#include <bits/stdc++.h>
using namespace std;

struct ListNode {
  int val;
  ListNode *next;
  ListNode(int x) : val(x), next(nullptr) {}
};

ListNode *createLinkedList(vector<int> &nums) {
  ListNode dummy(0);
  ListNode *cur = &dummy;
  for (int x : nums) {
    cur->next = new ListNode(x);
    cur = cur->next;
  }
  return dummy.next;
}

void printLinkedList(ListNode *head) {
  for (ListNode *cur = head; cur; cur = cur->next) {
    cout << cur->val << endl;
  }
}

int main() {
  int n;
  cin >> n; // è¯»å–æ•°ç»„é•¿åº¦

  vector<int> nums(n);
  for (int i = 0; i < n; i++) {
    cin >> nums[i]; // è¯»å–æ•°ç»„å…ƒç´ 
  }

  ListNode *head = createLinkedList(nums); // åˆ›å»ºé“¾è¡¨
  printLinkedList(head);                   // éå†é“¾è¡¨å¹¶è¾“å‡º

  return 0;
}
```

### äºŒå‰æ ‘çš„è¯»å…¥ä¸æ„å»ºï¼ˆè¾“å…¥ä¸ºæ•°ç»„å½¢å¼ï¼‰

> æœ¬é¢˜ç›¸å½“äºæ ¹æ®ã€Œå±‚åºéå†ã€ç»“æœæ¥æ„é€ äºŒå‰æ ‘ï¼šæœ¬è´¨å°±æ˜¯æ ¹æ®æ•°ç»„ç´¢å¼•æ¥æ„é€ 

âœ… æ¨èé˜…è¯»ï¼ˆ[**é¢˜è§£**](https://leetcode.cn/problems/construct-binary-tree-from-preorder-and-postorder-traversal/solutions/3653952/qian-zhong-hou-gou-zao-er-cha-shu-xi-lie-z1au/)ï¼‰ï¼š

- [889. æ ¹æ®å‰åºå’Œååºéå†æ„é€ äºŒå‰æ ‘](https://leetcode.cn/problems/construct-binary-tree-from-preorder-and-postorder-traversal/)
- [105. ä»å‰åºä¸ä¸­åºéå†åºåˆ—æ„é€ äºŒå‰æ ‘](https://leetcode.cn/problems/construct-binary-tree-from-preorder-and-inorder-traversal/)
- [106. ä»ä¸­åºä¸ååºéå†åºåˆ—æ„é€ äºŒå‰æ ‘](https://leetcode.cn/problems/construct-binary-tree-from-inorder-and-postorder-traversal/)
- [1008. å‰åºéå†æ„é€ äºŒå‰æœç´¢æ ‘](https://leetcode.cn/problems/construct-binary-search-tree-from-preorder-traversal/)

è¾“å…¥

```cpp
1 2 3 4 5 -1 6
```

æ ‘çš„ç»“æ„

```cpp
       1
      / \
     2   3
    / \   \
   4   5   6
```

è¾“å‡º

```cpp
1
2
3
4
5
6
```

é¢˜è§£

```cpp
#include <bits/stdc++.h>
using namespace std;

struct TreeNode {
  int val;
  TreeNode *left;
  TreeNode *right;
  TreeNode(int x) : val(x), left(nullptr), right(nullptr) {}
};

TreeNode *buildTree(const vector<int> &nums) {
  if (nums.empty() || nums[0] == -1)
    return nullptr;
  vector<TreeNode *> nodes(nums.size(), nullptr);
  for (size_t i = 0; i < nums.size(); i++) {
    if (nums[i] != -1)
      nodes[i] = new TreeNode(nums[i]);
  }
  for (size_t i = 0; i < nums.size(); i++) {
    if (nodes[i]) {
      if (2 * i + 1 < nums.size())
        nodes[i]->left = nodes[2 * i + 1];
      if (2 * i + 2 < nums.size())
        nodes[i]->right = nodes[2 * i + 2];
    }
  }
  return nodes[0];
}

void levelOrder(TreeNode *root) {
  if (!root)
    return;
  queue<TreeNode *> q;
  q.push(root);
  while (!q.empty()) {
    TreeNode *curr = q.front();
    q.pop();
    cout << curr->val << endl;
    if (curr->left)
      q.push(curr->left);
    if (curr->right)
      q.push(curr->right);
  }
}

int main() {
  string line;
  getline(cin, line);
  stringstream ss(line);
  vector<int> nums;
  int val;
  while (ss >> val) {
    nums.push_back(val);
  }
  TreeNode *root = buildTree(nums);
  levelOrder(root);
  return 0;
}
```

### æ™®é€šæ ‘çš„è¯»å…¥ä¸æ„å»ºï¼ˆè¾“å…¥ä¸ºç›¸é‚»è¾¹ & father æ•°ç»„ï¼‰

> åˆ†æˆä¸¤ç§å½¢å¼çš„è¯»å…¥ï¼Œä¸€èµ·è®²è§£

#### é¢˜ç›®æè¿°

ç»™å®šä¸€æ£µ **n** ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼ŒèŠ‚ç‚¹ç¼–å·ä¸º1âˆ’n1âˆ’*n*ï¼Œæ ‘çš„æ ¹èŠ‚ç‚¹å›ºå®šä¸º `1`ã€‚æˆ‘ä»¬æœ‰ä¸¤ç§æ–¹å¼è¡¨ç¤ºæ ‘çš„ç»“æ„ï¼š

1. **æ–¹å¼ä¸€**ï¼šé€šè¿‡ **n-1** æ¡è¾¹çš„å½¢å¼ï¼Œæ¯æ¡è¾¹ `u v` è¡¨ç¤ºèŠ‚ç‚¹ `u` å’ŒèŠ‚ç‚¹ `v` ä¹‹é—´å­˜åœ¨ä¸€æ¡è¾¹ã€‚
2. **æ–¹å¼äºŒ**ï¼šé€šè¿‡ä¸€ä¸ª **father** æ•°ç»„ï¼Œ`father[i]` è¡¨ç¤ºèŠ‚ç‚¹ `i+1` çš„çˆ¶èŠ‚ç‚¹ã€‚

è¯·ä½ ç¼–å†™ç¨‹åºï¼Œè¯»å…¥æ ‘çš„ç»“æ„å¹¶ä½¿ç”¨`æ·±åº¦ä¼˜å…ˆæœç´¢`éå†æ‰“å°è¿™æ£µæ ‘çš„èŠ‚ç‚¹ç¼–å·ã€‚

> ä¸ºäº†è¾“å‡ºç»Ÿä¸€ï¼Œä»æ ¹èŠ‚ç‚¹å¼€å§‹éå†ï¼Œä¼˜å…ˆè®¿é—®åºå·å°çš„å­èŠ‚ç‚¹ã€‚

#### è¾“å…¥

è¾“å…¥åŒ…å«ä¸‰éƒ¨åˆ†ï¼š

1. ç¬¬ä¸€è¡ŒåŒ…å«ä¸€ä¸ªæ•´æ•° `n`ï¼Œè¡¨ç¤ºæ ‘çš„èŠ‚ç‚¹ä¸ªæ•°ã€‚
2. ç¬¬äºŒè¡ŒåŒ…å«ä¸€ä¸ªæ•´æ•° `type`ï¼Œè¡¨ç¤ºæ ‘çš„è¡¨ç¤ºæ–¹å¼ï¼š
    - å¦‚æœ `type = 1`ï¼Œè¡¨ç¤ºé€šè¿‡è¾¹çš„å½¢å¼è¾“å…¥ã€‚
    - å¦‚æœ `type = 2`ï¼Œè¡¨ç¤ºé€šè¿‡ `father` æ•°ç»„è¾“å…¥ã€‚
3. å¦‚æœ `type = 1`ï¼Œæ¥ä¸‹æ¥ä¼šæœ‰ `n-1` è¡Œï¼Œæ¯è¡Œä¸¤ä¸ªæ•´æ•° `u v`ï¼Œè¡¨ç¤ºæ ‘ä¸­èŠ‚ç‚¹ `u` å’ŒèŠ‚ç‚¹ `v` ä¹‹é—´å­˜åœ¨ä¸€æ¡è¾¹ã€‚
4. å¦‚æœ `type = 2`ï¼Œæ¥ä¸‹æ¥ä¸€è¡Œæœ‰ `n` ä¸ªæ•´æ•°ï¼Œ`father[i]` è¡¨ç¤ºèŠ‚ç‚¹ `i+1` çš„çˆ¶èŠ‚ç‚¹ï¼Œå…¶ä¸­ `father[0] = 0`ï¼Œè¡¨ç¤º `1` å·èŠ‚ç‚¹ä¸ºæ ¹èŠ‚ç‚¹,æ²¡æœ‰çˆ¶èŠ‚ç‚¹ã€‚

#### è¾“å‡º

æ‰“å°éå†è¿™æ£µæ ‘çš„èŠ‚ç‚¹ç¼–å·ã€‚

#### è¾“å…¥æ ·ä¾‹ 1

```cpp
5
1
1 2
1 3
2 4
2 5
```

#### è¾“å‡ºæ ·ä¾‹ 1

```cpp
1 2 4 5 3
```

#### æ ·ä¾‹1 å›¾ä¾‹

```cpp
      1
     / \
    2   3
   / \
  4   5
```

#### è¾“å…¥æ ·ä¾‹ 2

```cpp
5
2
0 1 1 2 2
```

#### è¾“å‡ºæ ·ä¾‹ 2

```cpp
1 2 4 5 3
```

#### æ•°æ®èŒƒå›´

- $1\le n \le 10^5$

#### ğŸ”¥é¢˜è§£

```cpp
#include <algorithm>
#include <iostream>
#include <vector>
using namespace std;

#define MAX 100005 // å‡è®¾æœ€å¤§èŠ‚ç‚¹æ•° 10^5

vector<int> adjList[MAX];    // é‚»æ¥è¡¨
vector<int> traversalResult; // å­˜å‚¨å…ˆåºéå†ç»“æœ

void DFS(int node, int parent) {
  traversalResult.push_back(node);
  for (auto &child : adjList[node]) {
    if (child != parent) {
      DFS(child, node);
    }
  }
}

int main() {
  int n, type;
  cin >> n >> type;

  if (type == 1) {
    // type 1: é€šè¿‡è¾¹çš„å½¢å¼è¯»å…¥
    for (int i = 0; i < n - 1; i++) {
      int u, v;
      cin >> u >> v;
      adjList[u].push_back(v);
      adjList[v].push_back(u);
    }
  } else if (type == 2) {
    // type 2: é€šè¿‡ father æ•°ç»„è¾“å…¥
    vector<int> father(n + 1);
    for (int i = 1; i <= n; i++) {
      cin >> father[i];
      if (father[i] != 0) {
        adjList[father[i]].push_back(i);
        adjList[i].push_back(father[i]);
      }
    }
  }
  // ä¸ºäº†ä¿è¯éå†é¡ºåºçš„ä¸€è‡´æ€§ï¼Œå…ˆå¯¹æ¯ä¸ªèŠ‚ç‚¹çš„å­èŠ‚ç‚¹è¿›è¡Œæ’åº
  for (int i = 1; i <= n; i++) {
    sort(adjList[i].begin(), adjList[i].end());
  }

  DFS(1, 0);

  for (int i = 0; i < (int)traversalResult.size(); i++) {
    if (i > 0)
      cout << ' ';
    cout << traversalResult[i];
  }
  return 0;
}
```

### å›¾çš„æ„é€ ï¼ˆé‚»æ¥çŸ©é˜µ & é‚»æ¥è¡¨ï¼‰

#### é¢˜ç›®æè¿°

ç»™å®šä¸¤å¼ æœ‰å‘å›¾ A å’Œ Bï¼Œå…¶ä¸­å›¾ A ä»¥é‚»æ¥çŸ©é˜µå½¢å¼ç»™å‡ºï¼Œå›¾ B ä»¥é‚»æ¥è¡¨å½¢å¼ç»™å‡ºã€‚è¯·åˆ¤æ–­è¿™ä¸¤å¼ å›¾æ˜¯å¦å®Œå…¨ä¸€æ ·ã€‚æˆ‘ä»¬å°†â€œå®Œå…¨ä¸€æ ·â€çš„å®šä¹‰ä¸ºï¼šæ¯ä¸ªèŠ‚ç‚¹çš„é‚»å±…é›†åˆå®Œå…¨ä¸€è‡´ã€‚

#### è¾“å…¥

è¾“å…¥çš„ç¬¬ä¸€è¡ŒåŒ…å«ä¸¤ä¸ªæ•´æ•° nï¼Œè¡¨ç¤ºå›¾çš„èŠ‚ç‚¹æ•°ã€‚

æ¥ä¸‹æ¥çš„ n è¡Œï¼Œç»™å‡ºå›¾ A çš„é‚»æ¥çŸ©é˜µã€‚è¯¥çŸ©é˜µçš„ç¬¬ i è¡Œç¬¬ j åˆ—è¡¨ç¤ºèŠ‚ç‚¹ i å’ŒèŠ‚ç‚¹ j ä¹‹é—´æ˜¯å¦æœ‰è¾¹ã€‚å¦‚æœå­˜åœ¨è¾¹ï¼Œåˆ™è¯¥ä½ç½®çš„å€¼ä¸º 1ï¼Œå¦åˆ™ä¸º 0ã€‚

æ¥ä¸‹æ¥çš„ n è¡Œï¼Œç»™å‡ºå›¾ B çš„é‚»æ¥è¡¨ã€‚æ¯è¡Œç¬¬ä¸€ä¸ªæ•° node,åé¢è·Ÿçš„ç¬¬ä¸€ä¸ªæ•° k è¡¨ç¤ºæ¥ä¸‹æ¥è¾“å…¥ k ä¸ªæ•° val è¡¨ç¤ºèŠ‚ç‚¹ node å‘è¿™äº›èŠ‚ç‚¹ val è¿ä¸€æ¡è¾¹ã€‚

#### è¾“å‡º

å¦‚æœå›¾ A å’Œå›¾ B å®Œå…¨ä¸€æ ·ï¼Œåˆ™è¾“å‡º "YES"ï¼›å¦åˆ™è¾“å‡º "NO"ã€‚

#### æ³¨æ„

- å›¾ A å’Œå›¾ B æ˜¯æœ‰å‘å›¾ï¼Œå³å¦‚æœ `A[i][j]=1`ï¼Œé‚£ä¹ˆ i åˆ° j æœ‰æ¡æœ‰å‘è¾¹ã€‚
- èŠ‚ç‚¹ç¼–å·ä» 1 åˆ° nã€‚
- å›¾ A å’Œå›¾ B çš„èŠ‚ç‚¹æ•°ç›¸åŒã€‚
- æ•°æ®èŒƒå›´ï¼š
    - $1â‰¤nâ‰¤10^3$
    - å›¾ A çš„é‚»æ¥çŸ©é˜µå¤§å°ä¸º nÃ—nï¼Œå…¶ä¸­æ¯ä¸ªå…ƒç´ ä¸º 0 æˆ– 1ã€‚
    - å›¾ B çš„é‚»æ¥è¡¨ä¸­æ¯ä¸ªèŠ‚ç‚¹çš„é‚»å±…æ•°é‡ä¸è¶…è¿‡ nâˆ’1ã€‚

#### æ ·ä¾‹è¾“å…¥ 1

```cpp
3
0 1 1
1 0 1
1 1 0
1 2 2 3
2 2 1 3
3 2 1 2
```


#### æ ·ä¾‹è¾“å‡º 1

```cpp
YES
```


#### æ ·ä¾‹è¾“å…¥ 2

```cpp
3
0 1 1
1 0 1
1 1 0
1 2 2 3
2 2 1 3
3 1 1 
```


#### æ ·ä¾‹è¾“å‡º 2

```cpp
NO
```


#### æ ·ä¾‹ 2 æç¤º

å›¾ A çš„é‚»æ¥çŸ©é˜µä¸ºï¼š

```cpp
0 1 1
1 0 1
1 1 0
```

è¡¨ç¤ºå›¾ A ä¸­ï¼ŒèŠ‚ç‚¹ 1 ä¸èŠ‚ç‚¹ 2 å’ŒèŠ‚ç‚¹ 3 ç›¸è¿ï¼ŒèŠ‚ç‚¹ 2 ä¸èŠ‚ç‚¹ 1 å’ŒèŠ‚ç‚¹ 3 ç›¸è¿ï¼ŒèŠ‚ç‚¹ 3 ä¸èŠ‚ç‚¹ 1 å’ŒèŠ‚ç‚¹ 2 ç›¸è¿ã€‚

å›¾ B çš„é‚»æ¥è¡¨ä¸ºï¼š

```cpp
1 2 2 3
2 2 1 3
3 1 1
```

è¡¨ç¤ºå›¾ B ä¸­ï¼ŒèŠ‚ç‚¹ 1 ä¸èŠ‚ç‚¹ 2 å’ŒèŠ‚ç‚¹ 3 ç›¸è¿ï¼ŒèŠ‚ç‚¹ 2 ä¸èŠ‚ç‚¹ 1 å’ŒèŠ‚ç‚¹ 3 ç›¸è¿ï¼ŒèŠ‚ç‚¹ 3 ä¸èŠ‚ç‚¹ 1 ç›¸è¿ã€‚

å¯¹æ¯”å¯ä»¥å‘ç°ï¼Œåœ¨å›¾ B ä¸­ï¼ŒèŠ‚ç‚¹ 3 ä¸è¿å‘ èŠ‚ç‚¹ 2ã€‚å› æ­¤ï¼Œå›¾ A å’Œå›¾ B ä¸å®Œå…¨ä¸€æ ·ï¼Œè¾“å‡º "NO"ã€‚

#### é‚»æ¥çŸ©é˜µ

![img](https://cdn.jsdelivr.net/gh/Wu-yikun/OSS/PicGo/202504171613151.png)

#### é‚»æ¥è¡¨

![img](https://cdn.jsdelivr.net/gh/Wu-yikun/OSS/PicGo/202504171612514.png)

#### é¢˜è§£

```cpp
#include <algorithm>
#include <iostream>
#include <vector>
using namespace std;

int main() {
  int n; // é¡¶ç‚¹æ•°
  cin >> n;
  vector<vector<int>> adjA(n + 1), adjB(n + 1);

  // è¯»å–å¹¶è½¬æ¢å›¾ A
  for (int i = 1; i <= n; i++) {
    for (int j = 1; j <= n; j++) {
      int val;
      cin >> val;
      if (val == 1)
        adjA[i].push_back(j);
    }
  }

  // è¯»å–å›¾ B
  for (int i = 0; i < n; i++) {
    int node, k;
    cin >> node >> k;
    adjB[node].resize(k);
    for (int j = 0; j < k; j++) {
      cin >> adjB[node][j];
    }
  }

  // å¯¹é‚»æ¥è¡¨æ’åº
  for (int i = 1; i <= n; i++) {
    sort(adjA[i].begin(), adjA[i].end());
    sort(adjB[i].begin(), adjB[i].end());
  }

  // æ¯”è¾ƒé‚»æ¥è¡¨
  bool same = true;
  for (int i = 1; i <= n; i++) {
    if (adjA[i] != adjB[i]) {
      same = false;
      break;
    }
  }

  cout << (same ? "YES" : "NO") << endl;
  return 0;
}
```

